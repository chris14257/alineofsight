"use strict";function setAccessibility(e){null!=window.localStorage?($("html").removeClass(function(e,t){return(t.match(/(^|\s)altStyle\d+/g)||[]).join(" ")}),localStorage.setItem("altStyle",null),0<e&&($("html").addClass("altStyle"+e),localStorage.setItem("altStyle",e))):alert("This feature is not supported in this browser, please update")}function initialiseAddressLookup(){$(".hiddenExtraClass").each(function(e,t){validateAddress()&&enterAddress($(t).val())})}function enterAddress(e){$(".enterAddress"+e).removeClass("hidden"),$(".enterAddressMap").removeClass("hiddenLeft"),$(".formQuestion.addressStreet").addClass("hidden")}function validateAddress(){var e=$("input","div.formQuestion.enterAddressCity").val();return""!==e&&(""!==$("input","div.formQuestion.enterAddressLine1").val()&&""!==$("input","div.formQuestion.postcodeLookUp").val())}function validateAddressV2(){return checkPostcode("div.formQuestion.registerAddress.postcodeLookUp","#registerddlCountry")&&checkPostcode("div.formQuestion.DeliveryAddress.postcodeLookUp",".DeliveryAddress.enterAddressCountry select")&&_validateField("div.registerAddress.enterAddressLine1")&&_validateField("div.registerAddress.addressStreet",_checkUnselected)&&_validateField("div.registerAddress.enterAddressCity")}function showValidationError(e,t){var a=$(".validateError",e);a.is(":visible")||a.hide().removeClass("hidden").fadeIn().attr("aria-hidden","false"),$(e).get(0)&&$(e).get(0).scrollIntoView(),t.attr("aria-invalid","true")}function hideValidationError(e,t){$(".validateError",e).addClass("hidden").attr("aria-hidden","true"),t.attr("aria-invalid","false")}function checkPostcode(e,t){if($(e).length<=0)return!0;var a=$("input, textarea, select",e),n=a.val(),i=0<a.parents(".hidden").length,r=$(t+" option:selected").val(),t="28f16bce-6223-47dc-bf49-b233ec8e5cff"===r&&!checkPostCode(n),n="ca62daf4-7469-412a-bdba-a45f77ee941a"!==r&&0===n.length;return i||!t&&!n?(hideValidationError(e,a),!0):(showValidationError(e,a),!1)}function _checkUnselected(e){return"--"!==e}function initialiseAdminBar(){if($("select#postSelect").on("change",function(){var e=$(this).val().replace(/\-/g,"");$(".highlighted").removeClass("highlighted"),$(".post"+e).addClass("highlighted")}),$(".postApproval input").on("change",function(){var e=$(this).val();$.get("/BaseUI/v2_4/Handlers/ApprovalStatusChanged.ashx?idPost="+idPost+"&status="+e,function(e){})}),0<$(".adminBar").get().length&&"undefined"!=typeof Storage){var t=localStorage.getItem("sitecss"),e=$("link[id=platformStylesheet]")[0],a=parseInt($(e).attr("href").split("?v=")[1],10);if(null==t||null==t||""==t)(t={css:"",version:0}).date=(new Date).format("dd/M/yy h:mm tt");else try{t=JSON.parse(t)}catch(e){t=r(),localStorage.setItem("sitecss",null)}null!=t&&t.version>=a&&(e.disabled=!0,$("head").append("<style id='dynamic'>"+t.css+"</style>"),$("#liveCSS").removeClass("hidden"));var n=$("#dynamic"),i=t;setInterval(function(){if(null==(t=localStorage.getItem("sitecss"))||null==t)t=r();else try{t=JSON.parse(t)}catch(e){t=r(),localStorage.setItem("sitecss",null)}(null==i||null!=t&&t.css!=i.css)&&null!=t&&t.version>=a&&(e.disabled=!0,n.html(t.css),$("#liveCSS").removeClass("hidden")),i=t},500)}function r(){var e={css:"",version:0};return e.date=(new Date).format("dd/M/yy h:mm tt"),e}$(".sortable").sortable({handle:".handle",cursor:"move",placeholder:"ui-state-highlight",forcePlaceholderSize:!0,axis:"y",change:function(e,t){$(".saveChanges").removeClass("hidden")}}),$(".sortable").disableSelection()}function editLinkClick(){var e,t,a=$("#postSelect");return"--"===a.val()?window.location="/manager":(e=a.find(":selected").data("subsite").toLowerCase(),t="/?redirectIDPost=",t+=a.val(),t+="&isSubSite=",t+="true"===e?"1":"0",window.location=t),!1}function initialiseAppealDashboard(){$.datepicker.setDefaults($.datepicker.regional[""]),$(".inMemoryCreateStartDate input, .inMemoryCreateEndDate input, .inMemoryCreateLocationDate input").datepicker({dateFormat:"dd/mm/yy"}),$("input","div.formQuestion.inMemoryCreateTitle").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateTitle")}),$("textarea","div.formQuestion.inMemoryCreateOverview").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateOverview")}),$("input","div.formQuestion.inMemoryCreateStartDate").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateStartDate",_dateVal,!0)}),$("input","div.formQuestion.inMemoryCreateEndDate").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateEndDate",_dateVal,!0)}),$("input","div.formQuestion.inMemoryCreateLocationDate").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateLocationDate",_dateVal,!0)}),$("#includeDetails").on("click",function(){$(".inMemoryCreateLocationDetails").toggleClass("hidden")}),$("#othersFundraise").on("click",function(){$(".startFundraising").toggleClass("hidden")})}function uploadSuccess2(t){$.get("/BaseUI/v2_4/Handlers/BuildImageUrl.ashx?width=100&height=100&id="+t,function(e){$("#uploadedImage, #uploadedImage2").attr("src",e),$("#uploadedImage, #uploadedImage2").attr("data-imageid",t)})}function _IsNumber(e){return!isNaN(e)}function saveInMem(){if(!validateDash())return!1;$(".saveDetailsBtn").addClass("hidden"),$(".promoWait").removeClass("hidden");var e={idmf:$("#uploadedImage2").attr("data-imageid"),idappeal:$("#idappeal").val(),name:$("#name").val(),description:$("#inMemoryDescriptionEdit").val(),dateOfBirth:$("#dateOfBirth").val(),dateOfDeath:$("#dateOfDeath").val(),includeDetails:1==$("#includeDetails").prop("checked"),notes:$("#notes").val(),address:$("#address").val(),postcode:$("#postcode").val(),inMemoryCreateDate:$("#inMemoryCreateDate").val(),time:$("#time_Hours").val()+":"+$("#time_Mins").val(),allowComments:1==$("#allowComments").prop("checked"),moderateComments:1==$("#moderateComments").prop("checked"),postCreateAssociatedEvent:$("#postCreateAssociatedEvent").val(),othersFundraise:1==$("#othersFundraise").prop("checked"),totalAmountRaised:1==$("#totalAmountRaised").prop("checked"),donationsShow:1==$("#donationsShow").prop("checked")};return $.post("/BaseUI/v2_4/Handlers/InMemoryOf/SaveDetails.ashx",e).done(function(e){return"Error"==e?($(".saveDetailsBtn").removeClass("hidden"),$(".promoWait").addClass("hidden"),void alert("Sorry an error occured, please review the data and try again")):void location.reload(!0)}),!1}function validateDash(e){var t=[];t.push(_validateField("div.formQuestion.fundraiserTargetWrapper",_IsNumber)),t.push(_validateField("div.formQuestion.inMemoryCreateTitle"));for(var a=!0,n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function savePage(){var e=$("#uploadedImage").attr("data-imageid");if(!validateDash())return!1;var t={idmf:e,fundraiserDescriptionEdit:$("#fundraiserDescriptionEdit").val(),fundraiserTarget:$("#fundraiserTarget").val(),idappeal:$("#idappeal").val()};return $.post("/BaseUI/v2_4/Handlers/Fundraisers/SaveDetails.ashx",t).done(function(e){$(".appealTotaliser #targetAmount .totaliserFigure span").html(t.fundraiserTarget),location.reload()}),!1}function showTab(e,t){switch(e){case 0:$(".appealFundraisersWrapper, .fundraiserDashWrapper").addClass("hidden"),$(".appealComments").removeClass("hidden"),$(".tabs li").removeClass("active"),$(".tabs li:first-child").addClass("active");break;case 1:$(".appealFundraisersWrapper").removeClass("hidden"),$(".appealComments, .fundraiserDashWrapper").addClass("hidden"),$(".tabs li").removeClass("active"),$(t).parent().addClass("active");break;case 2:$("#fundraiserComments, #appealComments").addClass("hidden"),$("#fundraiserDashboard").removeClass("hidden"),$(".dashul li").removeClass("active"),$(".fdt").addClass("active"),$(".tabs li").removeClass("active"),$(".tabs li:last-child").addClass("active")}return!1}function currentProjectTab(){return $("ul.tabs li").removeClass("active"),$("li.cpt").addClass("active"),$("#completedProjects, #fundraisersSection").addClass("hidden"),$("#currentProjects").removeClass("hidden"),!1}function completedProjectsTab(){return $("ul.tabs li").removeClass("active"),$("li.copt").addClass("active"),$("#currentProjects, #fundraisersSection").addClass("hidden"),$("#completedProjects").removeClass("hidden"),!1}function fundraisersTab(){return $("ul.tabs li").removeClass("active"),$("li.ft").addClass("active"),$("#completedProjects, #currentProjects").addClass("hidden"),$("#fundraisersSection").removeClass("hidden"),!1}function cpsearch(){var e=$("#fundraiserSearch").val();return $("#fundraiserNameSearch").val(e),fundraisersTab(),!1}function copsearch(){var e=$("#fundraiserSearch2").val();return $("#fundraiserNameSearch").val(e),fundraisersTab(),!1}function currentProjectsLoadMore(e,t){return currentProjectsLoadMoreCombined(e,t,!1)}function currentProjectsLoadMoreCombined(e,t,a){if($("#curProjLoadMore").hasClass("disabled"))return!1;$("#curProjLoadMore").addClass("disabled"),e&&$("#curProjs").empty();var n=[];$('#currentProjects .categoryFilterContent input[type="checkbox"]').length?$('#currentProjects .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");n.push(e)}):$("#currentProjects .categoryFilterContent select").length&&$("#currentProjects .categoryFilterContent select").each(function(){var e=$(this).find(":selected").attr("value");"--"!==e&&n.push(e)});e=(e="CategoryTitle="+(0<n.length?n.join("|"):""!=$("#currentSingleFilters").val()?$("#currentSingleFilters").val():getParameterByName("CategoryTitle","/Category/")))+"&SubsiteTitle="+getParameterByName("SubsiteTitle","/Site/")+"&CombineFilters="+a,a=$("#curProjs .currentListedAppeal").get().length;return $.post("/BaseUI/v2_4/Handlers/Appeal/LoadMoreCurrentProjects.aspx?"+e,{startAt:a}).done(function(e){$("#curProjs").append(e),"True"!==$("#currentMoreToShow").val()?$(".currentProjectsListWrapper .loadMore").addClass("hidden"):$(".currentProjectsListWrapper .loadMore").removeClass("hidden"),0<$(".listedPost.listedAppeal.currentListedAppeal").length?(e=$("#totalCurrentAppeals").val(),$(".loadAmount.currentAppeals .runningTotal").text($(".listedPost.listedAppeal.currentListedAppeal").length),$(".loadAmount.currentAppeals .total").text(e)):($(".loadAmount.currentAppeals .runningTotal").text("0"),$(".loadAmount.currentAppeals .total").text("0")),$("#curProjLoadMore").removeClass("disabled")}),!1}function completedProjectsLoadMore(e,t){return completedProjectsLoadMoreCombined(e,t,!1)}function completedProjectsLoadMoreCombined(e,t,a){e&&$("#comProjs").empty();var n=[];$('#completedProjects .categoryFilterContent input[type="checkbox"]').length?$('#completedProjects .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");n.push(e)}):$("#completedProjects .categoryFilterContent select").length&&$("#completedProjects .categoryFilterContent select").each(function(){var e=$(this).find(":selected").attr("value");"--"!==e&&n.push(e)});e=(e="CategoryTitle="+(0<n.length?n.join("|"):""!=$("#completedSingleFilters").val()?$("#completedSingleFilters").val():getParameterByName("CategoryTitle","/Category/")))+"&SubsiteTitle="+getParameterByName("SubsiteTitle","/Site/")+"&CombineFilters="+a,a=$("#completedProjects .completedListedAppeal").get().length;return $.post("/BaseUI/v2_4/Handlers/Appeal/LoadMoreCompletedProjects.aspx?"+e,{startAt:a}).done(function(e){$("#comProjs").append(e),"True"!==$("#completedMoreToShow").val()?$(".completedAppealsListContent .loadMore").addClass("hidden"):$(".completedAppealsListContent .loadMore").removeClass("hidden"),0<$(".listedPost.listedAppeal.completedListedAppeal").length?(e=$("#totalCompletedAppeals").val(),$(".loadAmount.completedAppeals .runningTotal").text($(".listedPost.listedAppeal.completedListedAppeal").length),$(".loadAmount.completedAppeals .total").text(e)):($(".loadAmount.completedAppeals .runningTotal").text("0"),$(".loadAmount.completedAppeals .total").text("0"))}),!1}function singleLevelFilterClick(e,t){var a;0<$(t).parents("#currentProjects").length?($("#currentSingleFilters").val(e),a=$(t).text(),$("#currentProjects .appliedFilters").find("li > span").parent().remove(),$("#currentProjects .appliedFilters").removeClass("hidden").append('<li><span class="filter">'+a+" <a class=\"remove\" href=\"javascript: reset('currentAppeals')\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>"),currentProjectsLoadMore(!0,e)):0<$(t).parents("#completedProjects").length?($("#completedSingleFilters").val(e),a=$(t).text(),$("#completedProjects .appliedFilters").find("li > span").parent().remove(),$("#completedProjects .appliedFilters").removeClass("hidden").append('<li><span class="filter">'+a+" <a class=\"remove\" href=\"javascript: reset('completedAppeals')\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>"),completedProjectsLoadMore(!0,e)):(a=$(t).text(),$("#fundraisersSection .appliedFilters").find("li > span").parent().remove(),$("#fundraisersSection .appliedFilters").removeClass("hidden").append('<li><span class="filter">'+a+" <a class=\"remove\" href=\"javascript: reset('appeals')\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>"),loadFundraisersAjax(e,0,!1,!1))}function initialiseAppealList(){var e;0<$(".listedPost.listedAppeal.currentListedAppeal").length?(e=$("#totalCurrentAppeals").val(),$(".loadAmount.currentAppeals .runningTotal").text($(".listedPost.listedAppeal.currentListedAppeal").length),$(".loadAmount.currentAppeals .total").text(e)):($(".loadAmount.currentAppeals .runningTotal").text("0"),$(".loadAmount.currentAppeals .total").text("0")),0<$(".listedPost.listedAppeal.completedListedAppeal").length?(e=$("#totalCompletedAppeals").val(),$(".loadAmount.completedAppeals .runningTotal").text($(".listedPost.listedAppeal.completedListedAppeal").length),$(".loadAmount.completedAppeals .total").text(e)):($(".loadAmount.completedAppeals .runningTotal").text("0"),$(".loadAmount.completedAppeals .total").text("0")),$('#currentProjects .categoryFilterContent input[type="checkbox"]').length&&currentProjectsLoadMore(!0,!1),$('#completedProjects .categoryFilterContent input[type="checkbox"]').length&&completedProjectsLoadMore(!0,!1),$('#fundraisersSection .categoryFilterContent input[type="checkbox"]').length&&loadFundraisersAjax(processCheckboxesForAppealList("#fundraisersSection"),0,!1,!1),$("#currentProjects .categoryFilterContent select").length&&(currentProjectsLoadMoreCombined(!0,!1,!0),$("#currentProjects .clearcombinedfilters").on("click",function(){return reset("currentAppeals"),!1})),$("#completedProjects .categoryFilterContent select").length&&(completedProjectsLoadMoreCombined(!0,!1,!0),$("#completedProjects .clearcombinedfilters").on("click",function(){return reset("completedAppeals"),!1})),$("#fundraisersSection .categoryFilterContent select").length&&(loadFundraisersAjax(processDropdownsForAppealList("#fundraisersSection"),0,!1,!0),$("#fundraisersSection .clearcombinedfilters").on("click",function(){return reset("appeals"),!1})),$('#currentProjects .categoryFilterContent input[type="checkbox"]').on("change",function(){currentProjectsLoadMore(!0,!1)}),$('#completedProjects .categoryFilterContent input[type="checkbox"]').on("change",function(){completedProjectsLoadMore(!0,!1)}),$('#fundraisersSection .categoryFilterContent input[type="checkbox"]').on("change",function(){loadFundraisersAjax(processCheckboxesForAppealList("#fundraisersSection"),0,!1,!1)}),$("#currentProjects .categoryFilterContent select").on("change",function(){currentProjectsLoadMoreCombined(!0,!1,!0)}),$("#completedProjects .categoryFilterContent select").on("change",function(){completedProjectsLoadMoreCombined(!0,!1,!0)}),$("#fundraisersSection .categoryFilterContent select").on("change",function(){loadFundraisersAjax(processDropdownsForAppealList("#fundraisersSection"),0,!1,!0)})}function processCheckboxesForAppealList(a){var e=$(this).attr("value"),t=1==$(this).prop("checked"),n=$(this).parent().hasClass("firstLevelFilter");t?$(a+' .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$("#currentProjects .childOf-"+e+" > input").prop("checked",!0)}):uncheckAllChildrenForAppealList(e),n||t||$(this).parent().prevAll(a+" .firstLevelFilter:first").find("input").prop("checked",!1),$(a+" .appliedFilters").removeClass("hidden").find("li > span").parent().remove();var i,r=[];$(a+' .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$(a+"s .childOf-"+e+" > input").prop("checked",!0)}),$(a+' .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value"),t=$(this).next().text();$(a+" .appliedFilters").append('<li><span class="filter">'+t+" <a class=\"remove\" href=\"javascript: reset('currentAppeals')\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>"),r.push(e)});return 0<r.length?(i=r.join("|"),$("body").addClass("categoryFiltersOn")):(i=getParameterByName("CategoryTitle","/Category/"),$("body").removeClass("categoryFiltersOn")),i}function processDropdownsForAppealList(e){var t,a=[],n=getParameterByName("CategoryTitle","/Category/");$(e+" .categoryFilterContent select").each(function(){var e=$(this).find(":selected").attr("value");"--"!==e&&a.push(e)});return 0<a.length?(a.push(n),t=a.join("|"),$("body").addClass("categoryFiltersOn")):(t=n,$("body").removeClass("categoryFiltersOn")),t}function uncheckAllChildrenForAppealList(e){$("#currentProjects .childOf-"+e+" > input").prop("checked",!1)}function fundraiserSearchFunc2(){return $(".appealFundraisersWrapper, .fundraisersWrapper").removeClass("hidden"),$(".appealComments, .currentProjectsListing").addClass("hidden"),$(".tabs li").removeClass("active"),$(".tabs li:last-child").addClass("active"),$("#fundraiserNameSearch").val($("#fundraiserSearch").val()),window.location.hash="postFooterArea",fundraiserSearchFunc()}function initialiseAppealPost(){$("#fundraiserSearch").on("keydown",function(e){if(13==e.keyCode)return fundraiserSearchFunc2(),e.preventDefault(),!1}),$("#fundraiserNameSearch").on("keydown",function(e){if(13==e.keyCode)return fundraiserSearchFunc(),e.preventDefault(),!1})}function loadMoreBlogs(e){return loadBlogAjax("?StartAt="+e+"&NoMarkup=1",e,!0),!1}function loadBlogAjax(e,t,a){$.get("/BaseUI/v2_4/Handlers/ListingBlogsAjax.aspx"+e,function(e){var t=e;$(".listFooter").remove(),$(".listContent").append(t);e=$(".listContent > section").length;window.history&&window.history.pushState&&(t=window.location.href,$("<div>").append($(".listContent").clone()).html(),-1===t.indexOf("Take=")?-1===t.indexOf("?")?t+="?Take="+e:t+="&Take="+e:t=t.replace(/take\=(\d)*/gi,"Take="+e),history.pushState($(".listContent").html(),null,t)),0<$(".listedPost").length?$("#runningTotal").text($(".listedPost").length):$("#runningTotal").text("0")})}function initialiseBlogGroupList(){0<$(".listedPost").length?$("#runningTotal").text($(".listedPost").length):$("#runningTotal").text("0")}function ShowSignIn(){$(".registerWrapper").addClass("hidden")}function signInOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function registerOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function showMainContent(){$(".postCreatePageDetails, .postCreateButtons, .postFields").removeClass("hidden")}function validateBlogPost(e){var t=[];t.push(_validateField("div.formQuestion.postCreateTitle"));var a=validatePost();null==window.validateRegister||validateRegister(!0)||(a=!1);for(var n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function initialiseBlogPost(){$("input","div.formQuestion.postCreateTitle").on("blur",function(){_validateField("div.formQuestion.postCreateTitle")}),$("#btnCreate").on("click",function(e){return e.preventDefault(),!!validateBlogPost()&&(0<$("#firstName").get().length?register(function(){blogPostWork(!0)}):void blogPostWork(!1))})}function blogPostWork(e){var t=$("#appealTitle").val(),a=$("#appealOverview").val(),n=$("#postCreateContent").val(),i=imageVideoInput.imgID,r=imageVideoInput.vimeoID,o=imageVideoInput.youtubeID,s=$("#LocationpostcodeLookUp").val(),l=$("#LocationAddressLine1").val(),d=$("#LocationAddressLine2").val(),u=$("#LocationaddressCity").val(),c=$("#LocationddlCountry").val(),p=formInput.latLon,m=formInput.tags.join("|"),h=$("#notifyComments").prop("checked"),v=$("#confirmRights").prop("checked"),f=$("#hdnBlogID").val();$.post("/BaseUI/v2_4/Handlers/Create/Blog.ashx",{title:t,overview:a,content:n,imgID:i,vimeoID:r,youtubeID:o,postcode:s,address1:l,address2:d,townCity:u,idCountry:c,latLon:p,tags:m,allowComments:!0,notifyComments:h,confirmRights:v,blogGroupID:f,justRegistered:e}).done(function(e){var t=e.split("|");"NoReq"==(e=t[0])?($(".commentSuccessNoReq").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):"NoReqNP"==e?($(".commentSuccessNoReq, .noProfilePic").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):("Req"==e?$(".commentSuccessReq"):"ReqNP"==e?$(".commentSuccessReq, .noProfilePic"):$(".commentSuccessReg")).removeClass("hidden")})}$(document).ready(function(){var i={mainMenuLink:$("#menuMain a"),mainMenu:$("#menuMain"),mainMenuLinkWithSubMenu:$(".menuMain .hasSubmenu > a"),mainMenuAlt:$(".menuMainAlt")},n={esc:27,return:13,space:32,left:37,up:38,right:39,down:40},r={topLevel:"topLevel",hasSubMenu:"hasSubmenu",active:"active",menuAdminItems:".menuAdminAltItems"},o={ul:"ul",li:"li",a:"a"},s={tabIndex:"tabindex",ariaExpanded:"aria-expanded"},t=!1;function l(e,t){e.parent(o.ul).hasClass(r.topLevel)?(m(e,!1,!1,!0),c(e.children(o.ul).children(o.li).first())):a(t,e.parent(o.ul).children(o.li),e)}function d(e,t){e.parent(o.ul).hasClass(r.topLevel)?($(document.activeElement).prop(s.tabIndex,"-1"),a(t,e.parent(o.ul).children(o.li).not(r.menuAdminItems),e),$(document.activeElement).prop(s.tabIndex,"0")):e.hasClass(r.hasSubMenu)?(m(e,!1,!1,!0),c(e.children(o.ul).children(o.li).first())):e.parent(o.ul).parent(o.li).parent(o.ul).hasClass(r.topLevel)?(a(t,e.parent(o.ul).parent(o.li).parent(o.ul).children(o.li).not(r.menuAdminItems),e.parent(o.ul).parent(o.li)),h(e.parent(o.ul).parent(o.li))):u(e)}function u(e){e=e.parent(o.ul).parent(o.li);c(e),h(e)}function c(e){$(e).children(o.a).first().focus()}function a(e,t,a){for(var n=0,i=0;i<t.length;i++)if(t[i].id===a[0].id){n=i;break}e=n+e;e<0?e=t.length-1:e>=t.length&&(e=0),c(t[e])}function p(e){"true"===e.attr("aria-expanded")?e.attr("aria-expanded","false"):e.attr("aria-expanded","true")}function m(e,t,a,n){e=$(e).find("> ul");i.mainMenuAlt.is(":visible")&&e.removeAttr("style"),n?e.addClass(r.active):e.toggleClass(r.active),t?(a||e.stop().slideToggle(250),e.prev().attr(s.ariaExpanded,"false")):(e.stop().slideDown(250),e.prev().attr(s.ariaExpanded,"true"))}function h(e){e=$(e).find("> ul");e.stop().slideUp(250),e.prev().attr(s.ariaExpanded,"false")}i.mainMenuLink.prop(s.tabIndex,"-1"),i.mainMenu.find("a:first").prop(s.tabIndex,"0"),i.mainMenuLink.on("keydown",function(e){var t=$(document.activeElement).parent(o.li);if(null!=t){for(var a in n)if(n[a]===e.keyCode){e.preventDefault();break}e.keyCode===n.left?d(t,-1):e.keyCode===n.up?l(t,-1):e.keyCode===n.right?d(t,1):e.keyCode===n.down?l(t,1):e.keyCode===n.space||e.keyCode===n.return?document.activeElement&&document.activeElement.click():e.keyCode===n.esc&&u(t)}}),$("body").on({mouseenter:function(){i.mainMenuAlt.is(":visible")||m(this)},mouseleave:function(){i.mainMenuAlt.is(":visible")||h(this)}},"#menuMain ul li, #menuSub ul li"),i.mainMenuLinkWithSubMenu.on("click",function(e){e.preventDefault(),$(this).toggleClass("active"),p($(this)),m($(this).parent().get(0),!0,i.mainMenuAlt.is(":visible"))}),i.mainMenu.on("mouseover",function(e){t=!0}),i.mainMenu.on("mouseleave",function(e){t=!1}),$(document).keyup(function(e){e.keyCode===n.esc&&t&&h($("#menuMain a[aria-expanded=true]").parent())}),$(".menuMain li > span").on("click",function(e){e.preventDefault();e=$(this);e.toggleClass("active"),p(e.prev()),m(e.parent().get(0),!0,i.mainMenuAlt.is(":visible"))}),$("input[type=checkbox]").each(function(){this.setAttribute("role","checkbox"),this.setAttribute("aria-checked",this.checked)}),$("input[type=checkbox]").on("change",function(){this.setAttribute("aria-checked",this.checked)})});var intID=null,defaultChangeMS=5e3;function togglePaused(){var e=$(".bannerControlPauseWrapper");return 0<e.length?(e.removeClass("bannerControlPauseWrapper").addClass("bannerControlRotateWrapper").find("a").removeClass("bannerControlPause").addClass("bannerControlRotate").html("Rotate slides"),null!=intID&&(clearInterval(intID),intID=null)):((e=$(".bannerControlRotateWrapper")).removeClass("bannerControlRotateWrapper").addClass("bannerControlPauseWrapper").find("a").removeClass("bannerControlRotate").addClass("bannerControlPause").html("Pause slide"),null!=intID&&clearInterval(intID),intID=setInterval(function(){changeSlide(1)},defaultChangeMS)),!1}function changeSlide(e,t,a){var n,i,r;return!0!==window.vidPlaying&&($("iframe.youtube").each(function(){callPlayer($(this).attr("id"),"pauseVideo")}),n="#"+e+" > li, .bannerSlides > li",i=$(n).length,r=-1,$(n).each(function(){if(r+=1,!$(this).hasClass("hidden"))return null!=intID&&(clearInterval(intID),intID=setInterval(function(){changeSlide(1)},defaultChangeMS)),!1}),(r=i<=(r+=t)?0:r)<0&&(r=i-1),-1<a&&(r=a),$(n).addClass("hidden").attr("aria-hidden","true").find(".carouselSlideHeading a, .carouselSlideTitle.showsVideo").attr("tabindex","-1"),$("#"+e+" > li:nth-child("+(r+1)+"),.bannerSlides > li:nth-child("+(r+1)+")").removeClass("hidden").attr("aria-hidden","false").find(".carouselSlideHeading a, .carouselSlideTitle.showsVideo").attr("tabindex","0"),$(".carousel .activeSlide, .bannerButtons .activeSlide").removeClass("activeSlide"),$(".carouselButtons > li, .bannerButtons > li").each(function(){$(this).attr("aria-selected","false")}),$(".carousel #hc_"+r+", .bannerButtons #hc_"+r).addClass("activeSlide").attr("aria-selected","true"),null!=intID&&(clearInterval(intID),intID=setInterval(function(){!0!==window.vidPlaying&&changeSlide(e,1)},defaultChangeMS))),!1}function initialiseCarousel(){$(".carouselSlideDetail").on("click",function(e){var t=$(".selectDonationAmount",$(this)).get(0);null!=t&&jQuery.contains(t,e.target)||-1!=e.target.className.indexOf("buttonDonate")||-1!=e.target.className.indexOf("buttonFundraise")||(e=$(this).attr("data-url"),window.location=e)})}var recaptchaKey,imageVideoInput={imgID:null,vimeoID:null,youtubeID:null};function initialiseCommentImageVideo(){$(".uploadedImage a.remove").on("click",function(e){e.preventDefault(),imageVideoInput.imgID=null,$("#addImage").val(""),$(".uploadedImage").addClass("hidden"),$(".addImage, .commentImageWrapper").removeClass("hidden")}),$(".uploadedVideo a.remove").on("click",function(e){e.preventDefault(),imageVideoInput.vimeoID=null,imageVideoInput.youtubeID=null,$("#addVideo").val(""),$(".uploadedVideo").addClass("hidden"),$(".addVideo, .commentVideoWrapper").removeClass("hidden")}),$("#addVideo").on("change",function(){var e=$("#addVideo").val(),t=extractYouTubeVideoID(e);null==t?(t=extractVimeoVideoID(e),$(".uploadedVideo img").attr("src","/baseui/v2_4/images/vimeo.jpg"),imageVideoInput.vimeoID=t,imageVideoInput.youtubeID=null):($(".uploadedVideo img").attr("src","https://img.youtube.com/vi/"+t+"/default.jpg"),imageVideoInput.vimeoID=null,imageVideoInput.youtubeID=t),$(".uploadedVideo").removeClass("hidden"),$(".addVideo").addClass("hidden")})}function dropZoneSuccess(e){imageVideoInput.imgID=e}function extractVimeoVideoID(e){var t=e,e=t.indexOf(".com/");return t=t.substr(e+5,t.length-e-5)}function extractYouTubeVideoID(e){for(var t=null,a=e,e=a.indexOf("?"),n=0,i=(a=a.substr(e+1,a.length-e-1)).split("&").length;n<i;n++){var r=a.split("&")[n],o=r.split("=")[0],r=r.split("=")[1];if(o.toLowerCase()=="v".toLowerCase()){t=r;break}}return t}function initialiseComments(e){recaptchaKey=e,RecaptchaService.submitCallback=commentSubmit.submit,$("textarea","div.formQuestion.enterComment").on("blur",function(){_validateField("div.formQuestion.enterComment")}),$(".addComment").on("click",function(e){e.preventDefault(),commentSubmit.submit()})}var commentSubmit={submit:function(){validateRating()&&validateComments()&&getRecaptcha(function(e){e.execute(recaptchaKey,{action:"comment_submit"}).then(function(e){if($("#RecaptchaTokenV3").val(e),RecaptchaService.needsValidating)return RecaptchaService.versionThreeToken=e,RecaptchaService.email=$("#registeremail").val(),void RecaptchaService.validate();$(".addComment").addClass("hidden"),$(".commentPostWait").removeClass("hidden");var t=$("#commentText").val(),a=!0===$("#notifyComments").prop("checked"),n=$("#postID").val(),i=$("#productID").val(),e="";1===$("div.formQuestion.ratingOption input:checked").length&&(e=$("div.formQuestion.ratingOption input:checked").val()),void 0===window.imageVideoInput&&(imageVideoInput={imgID:null});t={postId:n,notify:a,imageId:imageVideoInput.imgID,rating:e,productId:i,recaptchaTokenV2:$("#RecaptchaTokenV2").val(),recaptchaTokenV3:$("#RecaptchaTokenV3").val(),registerEmail:$("#registeremail").val(),comment:t,registrationRequest:registration()};$.post("/frontend/api/comments",t).done(function(e){completeComment(e,n,i)}).fail(function(){failedComment()})})})}};function completeComment(e,t,a){"NoReq"===e?($(".commentSuccessNoReq").removeClass("hidden"),increaseCommentCount()):"NoReqNP"===e?($(".commentSuccessNoReq, .noProfilePic").removeClass("hidden"),increaseCommentCount()):("Req"===e?$(".commentSuccessReq"):"ReqNP"===e?$(".commentSuccessReq, .noProfilePic"):$("#unknown-comment-error").html(e)).removeClass("hidden"),$("li.menuAdminLogin a").text("Log out").attr("href","/logout"),loadMoreComments(t,a,0,!0),$("#commentText").val(""),$("#notifyComments").prop("checked",!1),$(".uploadedImage a.remove").click(),$(".commentPostWait").addClass("hidden"),$(".commentForm .content").slideUp()}function failedComment(){$(".commentPostWait").addClass("hidden"),$(".commentForm .content").slideUp(),$("#unknown-comment-error").html("Something went wrong. Please refresh the page and try again.").removeClass("hidden")}function registration(){var e=getRegisterRequest();return e.email?e.registering=1:e.registering=0,e.registerAction="comment",e}function increaseCommentCount(){var e=parseInt($(".commentcount").text().replace("(","").replace(")",""));$(".commentcount").text("("+(e+1)+")")}function isEmpty(e){return 0===e.length()}function validateComments(){var e=[];e.push(_validateField("div.formQuestion.enterComment"),isEmpty);var t=!0;null==window.validateRegister||validateRegister(!0)||(t=!1);for(var a=0,n=e.length;a<n;a++)e[a]||(t=!1);return jumpAndFocusError(),t}function validateRating(){if(null===document.querySelector(".productRating"))return!0;var e=null!==document.querySelector("div.formQuestion.ratingOption input:checked"),t=document.querySelector(".productRatingValidation");return e?(t.classList.add("hidden"),!0):(t.classList.remove("hidden"),!1)}function commentSignInOK(){$(".tabsWrapper, #registerComments").addClass("hidden"),$(".commentForm").removeClass("hidden")}function commentRegisterOK(e){return!!validateRegister()&&(register(function(e){$(".tabsWrapper, #registerComments").addClass("hidden"),$(".commentForm").removeClass("hidden")}),!0)}function loadMoreComments(e,t,a,n){var i="?PostID="+e+"&ProductID="+t+"&StartAt="+a;return!0===n&&(i+="&NumberToFetch=1"),loadCommentsAjax(e,t,i,a,!0!==n),!1}function loadCommentsAjax(t,a,e,n,i){$.get("/BaseUI/v2_4/Handlers/ListingCommentsAjax.aspx"+e,function(e){e&&0<e.length&&""!==e.trim()?(i?$(".commentsList").append(e):$(".commentsList").prepend(e),anyMoreComments?(e=parseInt($(".postCommentsAlt a.loadMore").attr("data-take")),$(".postCommentsAlt a.loadMore").attr("onclick","return loadMoreComments('"+t+"', '"+a+"', "+(n+e)+")").attr("href","?StartAt="+(n+e))):$(".postCommentsAlt a.loadMore").addClass("hidden")):$(".postCommentsAlt a.loadMore").addClass("hidden")})}function _emailVal(e){return validateEmail(e)}function initialiseContactUs(){$("input","div.formQuestion.firstName").on("blur",function(){_validateField("div.formQuestion.firstName")}),$("input","div.formQuestion.lastName").on("blur",function(){_validateField("div.formQuestion.lastName")}),$("input","div.formQuestion.email").on("blur",function(){_validateField("div.formQuestion.email",_emailVal)}),$("textarea","div.formQuestion.yourEnquiry").on("blur",function(){_validateField("div.formQuestion.yourEnquiry")})}function sendContactUsEnquiry(){if($("#enquirySubmitButton").prop("disabled",!0),!validateContactUs())return $("#enquirySubmitButton").prop("disabled",!1),!1;var e={firstName:$("div.formQuestion.firstName input").val().trim(),lastName:$("div.formQuestion.lastName input").val().trim(),email:$("div.formQuestion.email input").val(),enquiry:$("div.formQuestion.yourEnquiry textarea").val(),telephoneNumber:$("div.formQuestion.telephone input").val(),website:$("div.formQuestion.website input").val(),organisationName:$("div.formQuestion.organisationName input").val(),jobTitle:$("div.formQuestion.jobTitle input").val(),honeybeeritu:$("#honeybeeritu").val(),honeybeeritu2:$("#honeybeeritu2").val()};return $.post("/baseui/v2_4/handlers/contactenquiry.ashx",e).done(function(e){$(".mainC").slideUp(function(){$("html, body").animate({scrollTop:$("#confirmationMsg").offset().top}),$(document).scrollTop($("#confirmationMsg").offset().top)}),$("#confirmationMsg").html(e)}),!1}function validateContactUs(){var e=[];e.push(_validateField("div.formQuestion.firstName")),e.push(_validateField("div.formQuestion.lastName")),e.push(_validateField("div.formQuestion.email",_emailVal)),e.push(_validateField("div.formQuestion.yourEnquiry"));for(var t=!0,a=0,n=e.length;a<n;a++)e[a]||(t=!1);return t}function selectOfficeChange(){$(".contactOfficeAddress").addClass("hiddenLeft");var e=$("#selectOffice").val();$(".office"+e).removeClass("hiddenLeft")}var sw=document.body.clientWidth,bp=758;function buildMap(e,t,a){bp<sw?$(".mapContainer",e).length<1?buildEmbed(e,a):$(".staticMap",e).remove():$(".staticImg",e).length<1&&buildStatic(e,t)}function buildEmbed(e,t){$('<div class="mapContainer"/>').html(t).prependTo(e)}function buildStatic(e,t){var a=$(".mapLink",e).attr("href"),t=$('<img class="staticImg" />').attr("src",t);$('<a class="staticMap" />').attr("href",a).html(t).prependTo(e)}function defaultDonationPicked(e){var t=(e="div"!==e.tagName.toLowerCase()?e.parentNode:e).parentNode;$(t).find(".donationSelected").removeClass("donationSelected"),$(t).find(".donationAmount:not(.donationAmountOther)").attr("aria-checked",!1),$(t).find(".donationAmount:not(.donationAmountOther) input").attr("aria-checked",!1),$(t).find(".donationAmountOther label").attr("aria-checked",!1),$(t).find("input#donationAmountOther").val(""),$(e).addClass("donationSelected").attr("aria-checked",!0),$(e).find("input").prop("checked",!0).trigger("change"),$(e).find("input").attr("aria-checked",!0)}function otherClicked(e){var t=(e="div"!==e.tagName.toLowerCase()?e.parentNode:e).parentNode;$(t).find(".donationSelected").removeClass("donationSelected"),$(t).find(".donationAmount:not(.donationAmountOther)").attr("aria-checked",!1),$(t).find(".donationAmount:not(.donationAmountOther) input").attr("aria-checked",!1),$(t).find(".donationAmount input").prop("checked",!1).trigger("change"),$(e).find("label").attr("aria-checked",!0),$(e).addClass("donationSelected")}function otherChanged(e){$(".donationSelected").removeClass("donationSelected"),$("input#donationAmountOther").parent("div").addClass("donationSelected"),$(".donationAmount input").prop("checked",!1)}function donateParams(e){var t=$(e).attr("href"),a=$(e).closest("li");0==a.length&&(a=$(".quickGivingPanel"));e=$(".donationSelected input",a).val();return""!=e&&(t+="/"+e+"/"+((0<$(".regularPayment:checked",a).get().length?"DirectDebit":0<$(".regularPayment",a).get().length?"SinglePayment":$(".payType",a).val())||"")),window.location=t,!1}function dropzoneFileUploader(a){if(void 0===a.uploadUri)throw new Error("uploadUri not specified.");if(void 0===a.deleteUri)throw new Error("deleteUri not specified.");if(!0===a.saveFileId&&!$(a.saveFieldSelector).length)throw new Error("saveFieldSelector not found.");var n="";$(document).ready(function(){$("#uploadImage").dropzone({previewTemplate:document.querySelector("#preview-template").innerHTML,previewsContainer:"#preview-container",url:a.uploadUri,paramName:"image",acceptedFiles:"image/jpeg,image/png",dictDefaultMessage:"Click or just drag and drop a photo here",uploadMultiple:!1,clickable:"#preview-container, #uploadImage",thumbnailWidth:getImageWidth(),thumbnailHeight:getImageHeight(),init:function(){this.on("addedfile",function(){var t=this;$("#uploadImage .remove").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation(),0<t.files.length&&t.removeFile(t.files[0])}),void 0!==this.files[1]&&this.removeFile(this.files[0]),$(".remove").removeClass("hidden")}),this.on("removedfile",function(){$.ajax({type:"POST",url:a.deleteUri+encodeURIComponent(n),contentType:"application/json"}).always(function(){n="",$(a.saveFieldSelector).val("")})}),this.on("success",function(e,t){n=t,$(a.fileNameField).val(n),dropZoneSuccess(n),!0===a.saveFileId&&$(a.saveFieldSelector).val(n)}),setImageUploadImageRatios()}})})}function getImageWidth(){return windowWiderThan(newContainerWidth())?newPreviewImageWidth():container().width()}function getImageHeight(){return windowWiderThan(newContainerWidth())?previewImage().height():container().width()*heightToWidthRatio(previewImage())}function setImageUploadImageRatios(){var e=newContainerWidth();windowWiderThan(e)?(container().css("width",e),previewImage().css("width",newPreviewImageWidth)):(useCompactContainerMessage(),previewImage().css("width","100%"),e=previewImage().width()*heightToWidthRatio(previewImage()),previewImage().css("height",e))}function newPreviewImageWidth(){return previewImage().height()*widthToHeightRatio(previewImage())}function newContainerWidth(){return newPreviewImageWidth()-previewImage().width()+container().prop("offsetWidth")}function container(){return $("#uploadImage.dropzone")}function previewImage(){return $("#preview-container")}function useCompactContainerMessage(){$("#uploadImage .dz-message").html("<span>Tap to add an image</span>").css("width","100%")}function windowWiderThan(e){return $(window).width()>e}function widthToHeightRatio(e){return e.data("width")/e.data("height")}function heightToWidthRatio(e){var t=e.data("width");return e.data("height")/t}function ShowSignIn(){$(".registerWrapper").addClass("hidden")}function signInOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function registerOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function showMainContent(){$(".postCreatePageDetails, .postCreateEventDetails, .postCreateButtons, .postFields").removeClass("hidden")}function _dateValidate(e){return null!=e.match(/^\d\d?\/\d\d?\/\d\d\d\d$/)}function validateEvent(e){var t=[];t.push(_validateField("div.formQuestion.postCreateStartDate",_dateValidate)),t.push(_validateField("div.formQuestion.postCreateEndDate",_dateValidate)),t.push(_validateField("div.formQuestion.postCreateTitle"));var a=validatePost();null==window.validateRegister||validateRegister(!0)||(a=!1);for(var n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function initialiseEventCreate(){$("input","div.formQuestion.postCreateStartDate").on("blur",function(){_validateField("div.formQuestion.postCreateStartDate",_dateValidate)}),$("input","div.formQuestion.postCreateStartTime").on("blur",function(){_validateField("div.formQuestion.postCreateStartTime",_timeValidate)}),$("input","div.formQuestion.postCreateEndDate").on("blur",function(){_validateField("div.formQuestion.postCreateEndDate",_dateValidate)}),$("input","div.formQuestion.postCreateEndTime").on("blur",function(){_validateField("div.formQuestion.postCreateEndTime",_timeValidate)}),$("input","div.formQuestion.postCreateTitle").on("blur",function(){_validateField("div.formQuestion.postCreateTitle")}),$("#btnCreate").on("click",function(e){return e.preventDefault(),!!validateEvent()&&(0<$("#firstName").get().length?register(function(){eventCreateWork(!0)}):eventCreateWork(!1))})}function eventCreateWork(e){e={title:$("#eventName").val(),overview:$("#eventOverview").val(),content:$("#eventContent").val(),eventStartDate:$("#eventStartDate").val(),eventStartTime:$("#eventStart_Hours").val()+":"+$("#eventStart_Mins").val(),eventEndDate:$("#eventEndDate").val(),eventEndTime:$("#eventEnd_Hours").val()+":"+$("#eventEnd_Mins").val(),imgID:imageVideoInput.imgID,vimeoID:imageVideoInput.vimeoID,youtubeID:imageVideoInput.youtubeID,postcode:$("#LocationpostcodeLookUp").val(),address1:$("#LocationAddressLine1").val(),address2:$("#LocationAddressLine2").val(),townCity:$("#LocationaddressCity").val(),idCountry:$("#LocationddlCountry").val(),latLon:formInput.latLon,tags:formInput.tags.join("|"),allowComments:!0,notifyComments:$("#notifyComments").prop("checked"),confirmRights:$("#confirmRights").prop("checked"),justRegistered:e};$(".postCreateButtons").addClass("hidden"),$(".loadWait").removeClass("hidden"),$.post("/BaseUI/v2_4/Handlers/Create/Event.ashx",e).done(function(e){var t=e.split("|");e=t[0],$(".postCreateFormWrapper").slideUp(),$(".loadWait").addClass("hidden"),"NoReq"==e?($(".commentSuccessNoReq").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):"Req"==e?$(".commentSuccessReq").removeClass("hidden"):"NoReqNP"==e?($(".commentSuccessNoReq, .noProfilePic").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):("ReqNP"==e?$(".commentSuccessReq, .noProfilePic"):$(".commentSuccessReg")).removeClass("hidden"),$("html, body").animate({scrollTop:0},"fast")})}function changeTicketQuantity(t,a){var e,n,i=$(".row"+t+" input[type='text']"),r=i.val();return""===r&&(r=0),r=parseInt(r,10),null===a&&(e=parseInt(i.attr("currentQuantity"),10),r-=a=r-e),0<=r+a&&(n=r,i.attr("currentQuantity",n+=a),i.val(n),$.get("/BaseUI/v2_4/Handlers/UpdateTicketQuantity.ashx?productID="+t+"&quantity="+n,function(e){"false"!==e?($(".row"+t+" .buttonIcon.increaseQuantity").css("visibility","visible"),$(".row"+t+" .alert.productLiveOut").addClass("hidden"),i.val(n)):(i.val(r),i.attr("currentQuantity",r),1===a&&$(".row"+t+" .buttonIcon.increaseQuantity").css("visibility","hidden"),$(".row"+t+" .alert.productLiveOut.hidden").removeClass("hidden"))})),!1}function removeBasketItem(e){return $(e).parent().parent().remove(),!1}function submitBooking(e){return logRecaptchaAction("event_book_stage_two",e),$(".eventSecondStepButtons button.confirm").hide(),$(".preloader").show(),confirmBook()||($(".eventSecondStepButtons button.confirm").show(),$(".preloader").hide()),!1}function confirmBook(){if(!validateAttributes())return!1;var a="",t=[],n=!1,i=!1;if($(".basketContent tbody tr").each(function(){var e,t;0<$("input[type=text]",this).get().length&&(""!==a&&(a+="|"),""===(e=$("input[type=text]",this).val())&&(e="0"),e=parseInt(e),isNaN(e)?i=!0:(0<e&&(n=!0),t=$("input[type=hidden]",this).val(),a+=t+","+e))}),i)return alert("Your quantity value(s) must be a valid number (e.g. 1)"),!1;if(!n)return alert("Please add an event ticket"),!1;$("fieldset.ticketDetails, fieldset.extraItemDetails").each(function(){var n={},e=$(this).attr("id").replace("ta_","").replace("ea_","");n.productID=e,n.attributes=[],$(".formQuestion input[type='text'], .formQuestion textarea",this).each(function(){var e=$(this).attr("id").replace("txt_","").replace("txta_",""),t=$(this).val();n.attributes.push({productAttributeID:e,vals:[t],displayVals:[t]})}),$("fieldset.checkboxes",this).each(function(){var a,e=$(this).attr("id").replace("chk_","");0<$(".formQuestion input[type='checkbox']:checked",this).get().length&&(a={productAttributeID:e,vals:[],displayVals:[]},$(".formQuestion input[type='checkbox']:checked",this).each(function(){var e=$(this),t=e.attr("id").replace("cpafv_","");a.vals.push(t),a.displayVals.push(e.siblings(".checkboxRadio").text())}),n.attributes.push(a))}),$("fieldset.radioButton",this).each(function(){var a,e=$(this).attr("id").replace("rad_","");0<$(".formQuestion input[type='radio']:checked",this).get().length&&(a={productAttributeID:e,vals:[],displayVals:[]},$(".formQuestion input[type='radio']:checked",this).each(function(){var e=$(this),t=e.attr("id").replace("rpafv_","");a.vals.push(t),a.displayVals.push(e.siblings(".checkboxRadio").text())}),n.attributes.push(a))}),$(".formQuestion select",this).each(function(){var e=$(this),t=e.attr("id").replace("sel_",""),a=e.val(),e=e.find("option:selected").text();n.attributes.push({productAttributeID:t,vals:[a],displayVals:[e]})}),t.push(n)});var e={eventurl:$("#hdnTitleURL").val(),products:a,attributes:JSON.stringify(t)};return $.post("/BaseUI/v2_4/Handlers/BookEvent2.ashx",e).done(function(e){$(".eventSecondStepWrapper").addClass("hidden"),$(".eventThirdStepWrapper").removeClass("hidden"),window.location="/checkout"}),!0}function bookEvent(e){logRecaptchaAction("event_book_stage_one",e);var a="",n=!1,i=!1,r=!1;if($(".tickets .shoppingList tbody tr").each(function(){var e,t;0<$("input[type=text]",this).get().length&&(""!==a&&(a+="|"),""===(e=$("input[type=text]",this).val())&&(e="0"),e=parseInt(e),isNaN(e)?r=!0:(0<e&&(n=!0),t=$("input[type=hidden]",this).val(),a+=t+","+e))}),$(".extras .shoppingList tbody tr").each(function(){var e,t;0<$("input[type=text]",this).get().length&&(""!==a&&(a+="|"),""===(e=$("input[type=text]",this).val())&&(e="0"),e=parseInt(e),isNaN(e)?r=!0:(0<e&&(i=!0),t=$("input[type=hidden]",this).val(),a+=t+","+e))}),r)return alert("Your quantity value(s) must be a valid number (e.g. 1)"),!1;if(!n&&!i)return alert("Please add an event ticket"),!1;if(!n&&i)return alert("Extra items can't be bought without an event ticket. Please add a ticket to your order"),!1;$(".eventBookingBtn").addClass("hidden"),$(".postFooterWrapper").addClass("hidden"),$("#comments").addClass("hidden");e={eventurl:$("#hdnTitleURL").val(),products:a};return $.post("/BaseUI/v2_4/Handlers/BookEvent1.aspx",e).done(function(e){$(".ticketsWrapper, .extrasWrapper").addClass("hidden"),$(".eventSecondStepWrapper").removeClass("hidden").html(e),$("button.callToActionBtn.confirm").focus(),$("input, textarea, select","fieldset.ticketDetails, fieldset.extraItemDetails").first().focus()}),!1}function enquireAbout(e){e+=",1";$(".eventBookingBtn").addClass("hidden");e={eventurl:$("#hdnTitleURL").val(),products:e};return $.post("/BaseUI/v2_4/Handlers/BookEvent1.aspx",e).done(function(e){$(".ticketsWrapper, .extrasWrapper").addClass("hidden"),$(".eventSecondStepWrapper").removeClass("hidden").html(e),$("button.callToActionBtn.confirm").focus(),$("input, textarea, select","fieldset.ticketDetails, fieldset.extraItemDetails").first().focus()}),!1}sw=document.body.clientWidth,bp=758;function buildMap(e,t,a){bp<sw?$(".mapContainer",e).length<1?buildEmbed(e,a):$(".staticMap",e).remove():$(".staticImg",e).length<1&&buildStatic(e,t)}function buildEmbed(e,t){$('<div class="mapContainer"/>').html(t).prependTo(e)}function buildStatic(e,t){var a=$(".mapLink",e).attr("href"),t=$('<img class="staticImg" />').attr("src",t);$('<a class="staticMap" />').attr("href",a).html(t).prependTo(e)}function validateAttributes(e){var a=[];$("fieldset[data-required='True']").each(function(){var e=$(this);"True"===e.attr("data-required")&&a.push(_validateField("#"+e.attr("id")))}),$("select[data-required='True']").each(function(){var e=$(this);"True"===e.attr("data-required")&&a.push(_validateField("div#div_"+e.attr("id")))}),$("input[data-required='True']").each(function(){var e,t=$(this);"True"===t.attr("data-required")&&(t=_validateField(e="div#div_"+t.attr("id"))&&!isEmptyOrWhitespace(t.val()),$(".validateRequired",e).toggleClass("hidden",t).attr("aria-hidden",t?"true":"false"),a.push(t))}),$("textarea[data-required='True']").each(function(){var e,t=$(this);"True"===t.attr("data-required")&&(t=_validateField(e="div#div_"+t.attr("id"))&&!isEmptyOrWhitespace(t.val()),$(".validateRequired",e).toggleClass("hidden",t).attr("aria-hidden",t?"true":"false"),a.push(t))});for(var t=!0,n=0,i=a.length;n<i;n++)a[n]||(t=!1);return!0===e||0<(e=$(".alert.validateRequired:visible, .alert.validateError:visible")).get().length&&$("html, body").animate({scrollTop:$(e[0]).offset().top},"fast"),t}function isEmptyOrWhitespace(e){return!e||0===e.trim().length}function _numberVal(e){return e.match(/^\d{1,9}(\.\d\d)?$/)}function ShowSignIn(){$(".registerWrapper").addClass("hidden")}function registerOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function signInOK(){$(".tabWrapper, .registerWrapper").addClass("hidden"),showMainContent()}function showMainContent(){$(".postCreatePageDetails, .postCreateFundraising, .postCreateButtons, .postFields").removeClass("hidden"),loadDynamicTitle(null,null)}function loadDynamicTitle(e,t){var a={dynamicTitle:$("#appealTitle")[0].getAttribute("data-default")};null===e&&null===t||(a.firstName=e,a.lastName=t),$.ajax({url:"/frontend/api/fundraiser/title",type:"GET",data:a,dataType:"JSON",success:function(e){$("#appealTitle").val(e)}})}function validateAppealPost(e){var t=[];t.push(_validateField("div.formQuestion.postCreateTitle")),t.push(_validateField("div.formQuestion.postCreateTargetAmount",_numberVal,!0)),t.push(_validateField("div.formQuestion.postCreateParentAppeal"));var a=validatePost();null==window.validateRegister||validateRegister(!0)||(a=!1);for(var n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function setPageUrl(e){e&&(e=generateUrlSlug(e),$("#pageUrl").val(e))}function initialiseFormAppealPost(){setPageUrl($("#appealTitle").val()),configureSuggestedSummary(),configureSuggestedContent(),$("input","div.formQuestion.postCreateTitle").on("blur",function(){_validateField("div.formQuestion.postCreateTitle")}),$("input","div.formQuestion.postCreateTargetAmount").on("blur",function(){_validateField("div.formQuestion.postCreateTargetAmount",_numberVal,!0)}),$(".insert-text").on("click",function(){var e="#"+$(this).data("id");$(e).val($(e)[0].getAttribute("data-suggested-text"))}),$("#appealTitle").on("blur",function(){setPageUrl($(this).val())}),$("#pageUrl").on("input",function(){$('label[for="pageUrl"]').next(".alert").addClass("hidden")}),$("#postCreateParentAppeal").on("change",function(){$("#postCreateParentAppeal option[value='']").remove(),$("#loading-form").removeClass("hidden");var e=$("#postCreateParentAppeal").find(":selected").val();$.getJSON("/frontend/api/fundraisersettings/"+e,function(e){$("#appealTitle").val(e.title),$("#appealTitle").attr("data-default",e.defaultTitle),$("#appealOverview").attr("data-suggested-text",e.summary),configureSuggestedSummary(e.summary,$("#appealOverview")[0],$("insertTextSummary")),$("#postCreateContent").attr("data-suggested-text",e.content),configureSuggestedContent(e.content,$("#postCreateContent")[0],$("insertTextContent")),$("#postCreateTargetAmount").val(e.targetAmount),$("#btnCreate").text(e.submitButtonText),$("#loading-form").addClass("hidden"),$(".fundraiser-hidden").removeClass("fundraiser-hidden"),$("#fundraiser-image-upload").removeClass("fundraiser-invisible")})}),$("#btnCreate").on("click",function(e){if(e.preventDefault(),!validateAppealPost())return!1;var t=$("#pageUrl").val();if(!validateUrl(t)){e=$('label[for="pageUrl"]').next(".alert");return e.removeClass("hidden"),jumpAndFocusError(),pairValidationErrorAndInput(e,$("#pageUrl")),!1}$.getJSON("/frontend/api/pages/unique-url/"+t).done(function(e){return e?0<$("#firstName").get().length?register(function(){postWork(!0)}):postWork(!1):($('label[for="pageUrl"]').next(".alert").removeClass("hidden"),jumpAndFocusError(),!1)})}),$(".registerWrapper").on("input keyup","#firstName, #lastName",function(){loadDynamicTitle($("#firstName").val(),$("#lastName").val())})}function configureSuggestedSummary(){var e=$("#appealOverview")[0];configureSuggestedText(e.getAttribute("data-suggested-text"),e,$("#insertTextSummary"))}function configureSuggestedContent(){var e=$("#postCreateContent")[0];configureSuggestedText(e.getAttribute("data-suggested-text"),e,$("#insertTextContent"))}function configureSuggestedText(e,t,a){e?(t.placeholder="If you need help with what to write then click on 'Use our suggested text'",a.removeClass("hidden")):(t.placeholder="",a.addClass("hidden"))}function postWork(e){var t=$("#appealTitle").val(),a=$("#appealOverview").val(),n=$("#postCreateContent").val(),i=$("#postCreateTargetAmount").val(),r=$("#postCreateParentAppeal").val();null!=r&&""!=r||(r=$("#hdnAppealID").val());var o=$("#postCreateAssociatedEvent").val(),s=imageVideoInput.imgID,l=formInput.tags.join("|"),d=$("#notifyComments").prop("checked"),u=$("#confirmRights").prop("checked"),e={title:t,pageUrl:$("#pageUrl").val()||generateUrlSlug(t),overview:a,content:n,amount:i,appeal:r,event:o,imgID:s,tags:l,allowComments:!0,notifyComments:d,confirmRights:u,justRegistered:e};$(".postCreateButtons").addClass("hidden"),$(".loadWait").removeClass("hidden"),$.post("/BaseUI/v2_4/Handlers/Create/Appeal.ashx",e).done(function(e){var t=e.split("|");e=t[0];var a=t[1];if($(".postCreateFormWrapper").slideUp(),$(".loadWait").addClass("hidden"),"NoReq"==e)return $(".commentSuccessNoReq").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1]),void window.location.replace(a);("Req"==e?$(".commentSuccessReq"):$(".commentSuccessReg")).removeClass("hidden"),$("html, body").animate({scrollTop:0},"fast")})}function initialiseFormDonate(){$("#donationComment").on("blur",function(){validateDonationComment()}),$("#bodyForm").on("submit",function(e){return e.preventDefault(),!1});var e=getAmount();isNaN(e)&&(e=0),$("#DonationAmountPence").val(parseInt(100*e)),$(".donationAmount input").on("click",function(){checkLessThan1PoundDDError(),checkLessThan50pOneOffError()}),$("input#donationAmountOther").on("blur",function(){checkLessThan1PoundDDError(),checkLessThan50pOneOffError()}),updateRaised(e),$(".registerGiftAid button").on("click",function(){updateContactViaPost({StreetAddress:"",Place:""},$("#giftaidpostcodeLookUp").val())}),setCoverOurCostsAmount(),setGiftAidAmount(e),$("#giftAid").on("click",function(){getFullDonationAmount(getAmount())}),$("#covercosts").on("click",function(){getFullDonationAmount(getAmount())}),getFullDonationAmount(getAmount())}function getAmountIncludingCoverOurCosts(e){var t=0;return e+(t=coverOurCostsChecked()?getPercentageAmount(e):t)}function coverOurCostsEnabled(){return $("#CoverOurCostsContainer").length}function coverOurCostsChecked(){return!!coverOurCostsEnabled()&&$("#covercosts").prop("checked")}function getPercentageAmount(e){return e/100*parseFloat($("#coverOurCostsPercentage").val())}function setCoverOurCostsAmount(){var e;coverOurCostsEnabled()&&(e=getPercentageAmount(parseFloat($("#DonationAmountPence").val())/100),e=$("#htmlEncodedSymbol").val()+e.toFixed(2),$("#coverCostAmount").text(e))}function validateDonationComment(){var e=$("#donationComment"),t=$("#donationCommentError");return!0===/[<>]/.test(e.val())?(t.removeClass("hidden").fadeIn().attr("aria-hidden","false"),!1):(t.addClass("hidden").attr("aria-hidden","true"),!0)}function isMonthly(){return 0<$("#direct-debit:checked").get().length}function showHideRegister(){var e=checkAmountIsValid(),t=checkLessThan1PoundDDError(),a=checkLessThan50pOneOffError();if(e||!t||!a)return $(".registerWrapper").addClass("hidden"),void $(".donateStep2").addClass("hidden");isMonthly()?($(".donateMonthlyWrapper").addClass("hidden"),$(".registerForm, .registerWrapper").removeClass("hidden"),$(".donateStep2").addClass("hidden")):($(".registerWrapper").addClass("hidden"),$(".donateStep2").removeClass("hidden"))}function freqChanged(e){e||($(".donationDate, .donationPeriod").toggleClass("hidden"),$(".frequencySelected").removeClass("frequencySelected"),isMonthly()&&($("#direct-debit").parent("div").addClass("frequencySelected"),$(".donationAmountOneOffOtherErrorText").addClass("hidden")))}function showHideRegister2(){$(".registerFields").addClass("hidden"),$(".formQuestion.displayName.alt.hidden").removeClass("hidden"),$("#displayName").prop("checked")?$("#displayNameAlt").prop("checked",!0):$("#displayNameAlt").prop("checked",!1),$("#displayName").prop("checked",!1)}function showHideCardArea(){var e=checkAmountIsValid(),t=checkLessThan1PoundDDError(),n=checkLessThan50pOneOffError();if(e||0===getAmount()||!t||!n)return $(".donationGiftAid, .donationComment, .donateStep2, .donateMonthlyWrapper").addClass("hidden"),$(".donateStep1").removeClass("hidden"),$(".paymentFormWrapper").addClass("hidden"),void $(".registerWrapper").addClass("hidden");$(".donationGiftAid, .donationComment, .donateStep2").removeClass("hidden"),$(".donateStep1").addClass("hidden"),DDComplete||(isMonthly()?$(".donateMonthlyWrapper").removeClass("hidden"):($(".donateMonthlyWrapper").addClass("hidden"),0<a?$(".paymentFormWrapper, .donateStep2").removeClass("hidden"):$(".paymentFormWrapper").addClass("hidden")))}function getDonationPeriod(){return"month"}function getDonationPeriodPeriod(){var e;switch($("#donationPeriod").val()){case"Monthly":e=1;break;case"Quarterly":e=3;break;case"Yearly":e=12}return e}function getDonationDay(){return $("#donationDate").val().replace("st","").replace("th","").replace("nd","").replace("rd","")}function getAmount(){var e;return 0<$("input[name='amount']:checked").get().length?e=parseFloat($("input[name='amount']:checked").val()):$(".donationAmountOther").hasClass("donationSelected")?e=parseFloat($("#donationAmountOther").val().replace("","").replace(",","")):""!==$("#hdnPassedAmount").val()&&(e=parseFloat($("#hdnPassedAmount").val())),e}function defaultDonationPicked2(e){"div"!==e.tagName.toLowerCase()&&(e=e.parentNode),$(".donationSelected").removeClass("donationSelected"),$(".donationAmount:not(.donationAmountOther)").attr("aria-checked",!1),$("#donationAmountOtherLabel").attr("aria-checked",!1),$("input#donationAmountOther").val(""),$(e).addClass("donationSelected").attr("aria-checked",!0),$("input",e).prop("checked",!0).trigger("change"),donationAmountChanged2($("input",e).get(0))}function otherChanged2(e){$(".donationSelected").removeClass("donationSelected"),$("input#donationAmountOther").parent("div").addClass("donationSelected"),$(".selectDonationAmount input").prop("checked",!1).trigger("change"),donationAmountChanged2(e)}function checkLessThan1PoundDDError(){var e=getAmount();return isMonthly()&&e<1?($(".donationAmountOtherErrorText").removeClass("hidden"),$(".donationAmountOther").addClass("donationError"),!1):($(".donationAmountOtherErrorText").addClass("hidden"),$(".donationAmountOther").removeClass("donationError"),!0)}function validateAmount(){var e=checkAmountIsValid();return e||jumpAndFocusError(),e}function checkAmountIsValid(){var e=getAmount();return isNaN(e)?($(".donationAmountInvalid").removeClass("hidden"),$(".donationAmountOther").addClass("donationError"),!1):($(".donationAmountInvalid").addClass("hidden"),$(".donationAmountOther").removeClass("donationError"),!0)}function otherClicked2(){$(".donationSelected").removeClass("donationSelected"),$("input#donationAmountOther").parent("div").addClass("donationSelected"),$(".selectDonationAmount input").prop("checked",!1),freqChanged(!0)}function donationAmountChanged2(){checkAmountIsValid();var e=getAmount();isNaN(e)&&(e=1),$("#DonationAmountPence").val(parseInt(100*e)),updateRaised(e),setGiftAidAmount(e),PaymentManager._syncUrlState(),freqChanged(!0),setCoverOurCostsAmount(),getFullDonationAmount(e)}function setGiftAidAmount(e){e=getAmountIncludingCoverOurCosts(e);e*=1.25,$(".donationGiftAidAmount").text(""+e.toFixed(2))}function setupTermsAndConditions(){getFullDonationAmount(getAmount());var e=PaymentManager.getSelectedPaymentMethod();"credit-card"===e||"google-pay"===e||"apple-pay"===e?$("#terms-and-conditions-section").addClass("hidden"):$("#terms-and-conditions-section").removeClass("hidden")}function getFullDonationAmount(e){var t,a=PaymentManager.getSelectedPaymentMethod();"credit-card"!==a&&"google-pay"!==a&&"apple-pay"!==a?(t=$("#htmlEncodedSymbol").val(),a="Donate",0!==(e=parseFloat(getAmountIncludingCoverOurCosts(e)).toFixed(2))&&(a+=" "+t+e),$("#donateBtn").html(a)):$("#donateBtn").html("Add payment details")}function updateRaised(e){var t=e+baseAmountRaised,e=numberWithCommas(e+baseAmountRaised);$(".raisedWrapper > .totaliserFigure span").text(e);e=0,t=100/(e=0<$(".targetAmount.totaliserFigure").length?parseInt($(".targetAmount.totaliserFigure span").html().replace(/\,/gi,"")):e)*t;100<t&&(t=100),$(".totaliserDone").css("height",t+"%")}function numberWithCommas(e){return e.toFixed(2).replace(".00","").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function CardPaymentPostcodeLookup(e,t){$(".contactViaPost label span").text(" at "+e.StreetAddress+", "+e.Place),showHideRegister(),updateContactViaPost(e,t)}function updateContactViaPost(e,t){0<$(".dataProtection .addressArea.hidden").get().length&&($("#AddressLine1").val(e.StreetAddress),$("#AddressLine2").val(""),$("#addressCity").val(e.Place),$("#postcodeLookUp").val(t))}function checkLessThan50pOneOffError(){var e=getAmount();return!isMonthly()&&e<.5?($(".donationAmountOneOffOtherErrorText").removeClass("hidden"),$(".donationAmountOther").addClass("donationError"),!1):($(".donationAmountOneOffOtherErrorText").addClass("hidden"),$(".donationAmountOther").removeClass("donationError"),!0)}function postLoginWork(e){$(".formQuestion.displayName.alt.hidden").removeClass("hidden"),$("#displayName").prop("checked")?$("#displayNameAlt").prop("checked",!0):$("#displayNameAlt").prop("checked",!1),$("#displayName").prop("checked",!1),showHideCardArea(),fillInAddress(),freqChanged(!0),setTimeout(function(){$("#cardNumber").focus()},200)}function fillInAddress(){$.get("/baseui/v2_4/handlers/useraddress.ashx",function(e){"False"!==e&&(""===$("#billingAddressLine1").val()&&(e=e.split(","),$("#billingAddressLine1").val(e[0]),$("#billingAddressLine2").val(e[1]),$("#billingaddressCity").val(e[2]),$("#billingddlCountry").val(e[3]),$("#billingpostcodeLookUp").val(e[4])),$(".enterAddress.CardPaymentAddress.hidden").removeClass("hidden"))})}function _dateVal(e){return e.match(/^(\d)?\d[\/](\d)?\d[\/]\d\d\d\d$/)}function _emailVal(e){return validateEmail(e)}function telephoneNumberValidation(e){return e.length<=20}function validateMyDetails(){var e=[];e.push(_validateField("div.formQuestion.firstName")),e.push(_validateField("div.formQuestion.lastName")),e.push(_validateField("div.formQuestion.email",_emailVal)),e.push(_validateField("div.formQuestion.dateOfBirth",_dateVal,!0)),e.push(_validateField("div.formQuestion.telephone",telephoneNumberValidation,!0)),e.push(_validateField("div.formQuestion.mobile",telephoneNumberValidation,!0)),e.push(_validateField("div.formQuestion.password",validatePassword,!0)),$("#contactViaPost").prop("checked")&&e.push(validateMyDetailsAddress());var t=!!window.hasOwnProperty("titleRequired")&&window.titleRequired;e.push(_validateField("div.formQuestion.title",_titleVal,!t));for(var a=!0,n=0,i=e.length;n<i;n++)e[n]||(a=!1);(a?checkEmailInUse:jumpAndFocusError)()}function checkEmailInUse(){var e=$("#email").val(),t=$("#originalEmail").val();jQuery.ajax({method:"GET",url:"/frontend/api/member-details/email/in-use",data:{newEmail:e,originalEmail:t},success:function(e){e.success?($(".email > span.emailInUseError ").addClass("hidden"),$("#btnUpdate").click()):((e=$(".email > span.emailInUseError ")).removeClass("hidden"),$("html, body").animate({scrollTop:e.offset().top},"fast"))}})}function populateCommunicationPreferences(){$.get("/frontend/api/member-communication",function(e){var i;e&&($("#contactViaEmail").prop("checked",e.receiveEmailFromOrganisation),$("#contactViaPost").prop("checked",e.receivePostFromOrganisation),$("#contactViaTel").prop("checked",e.receiveTelFromOrganisation),$("#contactViaSMS").prop("checked",e.receiveSmsFromOrganisation),i=e.contactReasons,$(".contactReasonOption").each(function(e,t){var a=$(t),n=a.find("label").text(),t=a.find("input:checkbox"),a=$.grep(i,function(e){return e.reason===n});0===a.length&&(a[0]={canContact:!1}),t.prop("checked",a[0].canContact)}),updateContactReasons())})}function validateMyDetailsAddress(){return checkPostcode("div.formQuestion.formSecondStep.postcodeLookUp","#ddlCountry")&&_validateField("div.formQuestion.formSecondStep.enterAddressLine1")&&_validateField("div.formQuestion.formSecondStep.addressStreet",_checkUnselected)&&_validateField("div.formQuestion.formSecondStep.enterAddressCity")}function initialiseFormMyDetails(){populateCommunicationPreferences(),$("input","div.formQuestion.firstName").on("blur",function(){_validateField("div.formQuestion.firstName")}),$("input","div.formQuestion.lastName").on("blur",function(){_validateField("div.formQuestion.lastName")}),$("input","div.formQuestion.email").on("blur",function(){_validateField("div.formQuestion.email",_emailVal)}),$("input","div.formQuestion.title").on("blur",function(){_validateField("div.formQuestion.title",_titleVal,!(!!window.hasOwnProperty("titleRequired")&&window.titleRequired))}),$.get("/BaseUI/v2_4/Handlers/HasProfilePic.ashx",function(e){"True"==e&&$(".buttonIcon.remove.hidden").removeClass("hidden")})}function emailChanged(){var e=$("#email").val();$(".contactViaEmail > label > span").text("at "+e)}function addressChanged(){var e=[$("#AddressLine1").val(),$("#AddressLine2").val(),$("#addressCity").val(),$("#postcodeLookUp").val(),$("#ddlCountry option:selected").text()],e=$.grep(e,function(e){return!!(e&&0<e.length)&&""!==e.trim()}).join(", ");$("div.formQuestion.formSecondStep.contactViaPost > label").text("Via post at "+e)}function telChanged(){var e=$("#telephone").val(),t=$("#mobile").val();""!=e&&""!=t?$(".contactViaTel > .yourInput").removeClass("hidden").text("on "+e+" or "+t):""!=e?$(".contactViaTel > .yourInput").removeClass("hidden").text("on "+e):""!=t?$(".contactViaTel > .yourInput").removeClass("hidden").text("on "+t):$(".contactViaTel > .yourInput").addClass("hidden"),""!=t?$(".contactViaSMS > .yourInput").removeClass("hidden").text("on "+t):$(".contactViaSMS > .yourInput").addClass("hidden")}function removeProfilePicture(){return $(".buttonIcon.remove").addClass("hidden"),$.get("/BaseUI/v2_4/Handlers/RemoveProfilePic.ashx",function(e){$("#uploadedImage").attr("src","/handlers/displayprofilepic.ashx")}),!1}function validatePassword(){var e=$("#password").val();if(e.length<6)return!1;for(var t=!1,a=!1,n=!1,i=0,r=e.length;i<r;i++){var o=e[i];!a&&isNaN(o)&&o===o.toLowerCase()&&(a=!0),!t&&isNaN(o)&&o===o.toUpperCase()&&(t=!0),n||isNaN(o)||(n=!0)}return!!(a&&t&&n)}$(document).on("click",".faqQuestion",function(){var e=$(event.target),t=e.closest(".faqQuestion"),a=t.next(".faqAnswer");0!==a.length&&(event.preventDefault(),e.closest(".listedFaq").toggleClass("accordianOpen"),a.attr("aria-expanded","false"===a.attr("aria-expanded")?"true":"false"),a.toggleClass("hidden"),a.hasClass("hidden")||raisePostCounter(t.attr("data-id")))});var paymentStep=1,deliveryOptionPlaceholder="00000000-0000-0000-0000-000000000000_0__False_0",promoAmount=0,promoType=null;function _cardPostCodeVal(e){return!("28f16bce-6223-47dc-bf49-b233ec8e5cff"==$(".CardPaymentAddress.enterAddressCountry select option:selected").val())||checkPostCode(e)}function initialiseFormPayment(){delChanged(),updateTotal(),$("#bodyForm").on("submit",function(e){return!1}),$(".donateContinue").on("click",function(){validateCard()}),$(".formQuestion.displayName.alt").remove()}function checkAndApplyPromoCode(){var a=$("#promoCode").val();return""!=a&&($(".promoWait").removeClass("hidden"),$("#applyPromo").addClass("hidden"),$.get("/BaseUI/v2_4/Handlers/CheckPromoCode.ashx?code="+encodeURIComponent(a)+"&d="+new Date,function(e){var t=e.split("|");"OK"==t[0]?(applyPromoCode(a,t),$(".promoCode span.validateRequired").addClass("hidden")):($(".promoCode span.validateRequired").removeClass("hidden").text(e),$(".promoWait").addClass("hidden"),$("#applyPromo").removeClass("hidden"),$("#promoCode").val(""))})),!1}function removePromoCode(){$.ajax({url:"/frontend/api/shopping-basket/promo-code",method:"DELETE",success:function(){location.reload()}})}function applyPromoCode(e,t){$("#hdnPromoCode").val(e),promoType=t[1],promoAmount=parseFloat(t[2]);var a=t[3],e=t[4],n=parseInt(t[5]);$(".promoCode").remove(),$(".shoppingList tbody").append(["<tr class='itemRow'>","<td class='itemColumn'>","\t<h3 class='itemName'>Discount code: "+e+"</h3>","</td>","<td class='quantityColumn'>","<input type='hidden' class='hdnWeight' value='0'>","\t",n,"</td>","<td class='priceColumn'>","&nbsp;","</td>","<td class='removeColumn'>","<a class='buttonIcon remove' href='javascript: removePromoCode(); void(0);' title='Remove discount code'>Remove</a>","</td>","</tr>"].join("\n"));var i=0;$(".shoppingList tbody tr.itemRow").each(function(){var e=$(".hdnProductID",this).val();-1<a.indexOf(e)&&i++<n&&(e=parseFloat($(".price",this).html().replace(window.PaymentManager.currencySymbol(),"").replace(/,/gi,"")),"Fixed"==promoType?e-=promoAmount:100==promoAmount?e=0:e-=e*(parseFloat(promoAmount.toString())/100),e<0&&(e=0),$(".price",this).html(window.PaymentManager.currencySymbol()+evenRound(e,2).toFixed(2)),$(this).data("price",evenRound(e,2).toFixed(2)),$(".hdnPrice",this).val(evenRound(e,2)))}),$(".shoppingList tbody tr.itemRow").eq(0).trigger("cartItemChanged");e=updateTotal();updateVAT(),0==e?calculateStep(!0):calculateStep()}function calculateStep(e){var t=!1;$("td.quantityColumn input[type='text']").each(function(){0<$(this).val()&&(t=!0)}),paymentStep=t?2:1}function updateDisplay(){switch(paymentStep){case 1:hideDelivery(),hideRegister(),hidePayBtn(),showContinueButton();break;case 2:showDelivery(),showRegistrationForPayment(!0),showHidePayBtn(),hideContinueButton()}}function hideRegister(){$("[data-step=register]").addClass("hidden")}function showRegistrationForPayment(){"Log out"!=$("li.menuAdminLogin a:first").text()&&$("[data-step=register]").removeClass("hidden")}function hideContinueButton(){$(".donateContinue").addClass("hidden")}function showContinueButton(){$(".donateContinue").removeClass("hidden")}function hideDelivery(){$("[data-step=delivery]").addClass("hidden")}function showDelivery(){$("[data-step=delivery]").removeClass("hidden")}function hidePayBtn(){$(".payBtnArea").addClass("hidden")}function showHidePayBtn(){0==$(".registerWrapper").get().length||$(".registerWrapper").hasClass("hidden")?$(".payBtnArea").removeClass("hidden"):$(".payBtnArea").addClass("hidden")}function _deliveryVal(e){return e!==deliveryOptionPlaceholder&&""!=e&&null!=e}function validateDelivery(){return!(0<$("#deliveryOptions:visible").get().length&&!_validateField("div.formQuestion.deliveryAmount",_deliveryVal))||(jumpAndFocusError(),!1)}function pay(){if(null!=window.validateRegister&&!validateRegister(!0))return!1;if(!validateDelivery())return!1;var e;0<$(".registerForm div.formQuestion.firstName input").get().length&&(e=$(".registerForm div.formQuestion.firstName input").val().trim(),a=$(".registerForm div.formQuestion.lastName input").val().trim(),$("#hdnName").val(e+" "+a)),$(".pay-btn, .callToActionBtn.register").addClass("hidden"),$(".payWait, .loadWait").removeClass("hidden");var t,a=$(".enterAddressCountry select option:selected").text();return $(".enterAddressCountry input[type='hidden']").val(a),1==window.enquiry||null==window.Stripe||0===updateTotal()?(t=$("#bodyForm"),$("#__EVENTTARGET, #__EVENTARGUMENT, #__VIEWSTATE",t).remove(),t.attr("action","/Pages/Payment/In.aspx"),t.get(0).submit()):(t=$("#bodyForm"),Stripe.createToken(t,stripeResponseHandler)),!1}function changeQuantity(a,e){if(0<e&&"NoIncrease"===window[a+"Quantity"])return!1;var t,n=$(".row"+a).find("input[type='text']"),i=n.val();return""==i&&(i="0"),i=parseInt(i,10),null===e&&(t=parseInt(n.attr("currentQuantity"),10),i-=e=i-t),0<=i+e&&(t=i,n.attr("currentQuantity",t+=e),n.val(t),$(".row"+a).trigger("cartItemChanged"),$.get("/BaseUI/v2_4/Handlers/UpdateBasketQuantity.ashx?IDOrderProduct="+a+"&quantity="+t,function(e){var t=e;"false"!=e?($(".listFooter").remove(),$(".blogGroupsPage > .listing").append(t),window[a+"Quantity"]=null,$(".row"+a+" .alert.productLiveOut").addClass("hidden"),updateVAT(),updateTotal(),showHideDelivery(),delChanged()):(n.val(i),n.attr("currentQuantity",i),window[a+"Quantity"]="NoIncrease",$(".row"+a+" .alert.productLiveOut.hidden").removeClass("hidden"))})),!0}function removeItem(e){var t=$(".row"+e),a=t.find("input[type='text'][currentQuantity]");a.val(0),a.prop("currentQuantity",0),t.trigger("cartItemChanged"),t.remove(),$.get("/BaseUI/v2_4/Handlers/RemoveBasketItem.ashx?IDOrderProduct="+e,function(e){showHideDelivery(),delChanged(),updateVAT(),updateTotal()})}function removeBasketItem(e,t,a){var n=$(".row"+e),i=n.find("input[type='text'][currentQuantity]");i.val(0),i.prop("currentQuantity",0),n.trigger("cartItemChanged"),n.remove(),t&&$(".row"+a).remove(),$.get("/BaseUI/v2_4/Handlers/RemoveBasketItem.ashx?IDOrderProduct="+e,function(e){showHideDelivery(),delChanged(),updateVAT(),updateTotal()})}function removeDonation(){$(".addDonation").remove(),donationAmountChanged()}function donationAmountChanged(){var e=$("#donationAmount").val();""==e&&(e=0),0<(e=(e=parseFloat(e,10))<0?0:e)?($(".donationGiftAid, .displayName, .paymentForm").removeClass("hidden"),e=1.25*e,$(".donationGiftAidAmount").text(window.PaymentManager.currencySymbol()+evenRound(e,2).toFixed(2))):$(".donationGiftAid, .displayName").addClass("hidden"),$(".itemRow[data-id]").eq(0).trigger("cartItemChanged"),updateVAT(),updateTotal()}function updateVAT(){var a=0;$(".shoppingList tbody tr.itemRow").each(function(){var e=parseInt($("input[type='text']",this).val(),10);e<0&&(e=0);var t=parseFloat($(".hdnPrice",this).val());isNaN(t)||"true"!=$(".hdnVATExempt",this).val()&&(t=roundAmount(t=t/100*parseFloat($(".hdnVATRate",this).val()),2),a+=t*e)});var e,t=$("#deliveryOptions").val(),n=!1;return""!=t&&null!=t&&(""==(e=t.split("_"))[0]||"00000000-0000-0000-0000-000000000000"==e[0]?t=0:(t=parseFloat(e[1]),n="True"==e[3]),n&&(e=parseFloat("0."+e[4].replace(".","")),a+=t*=e)),$(".vat span").text(window.PaymentManager.currencySymbol()+evenRound(a,2).toFixed(2)),a}function roundAmount(e,t){t=Number(Math.round(e+"e"+t)+"e-"+t).toFixed(t);return parseFloat(t)}function evenRound(e,t){var a=t||0,n=Math.pow(10,a),i=+(a?e*n:e).toFixed(8),t=Math.floor(i),e=i-t,i=.5-1e-8<e&&e<.5+1e-8?t%2==0?t:t+1:Math.round(i);return a?i/n:i}function getNumberOfItems(){var t=0;return $(".shoppingList tbody tr.itemRow").each(function(){var e=parseInt($("input[type='text']",this).val(),10);isNaN(e)||(t+=e)}),t}function basketTotalIncVat(){var a=0;return $(".shoppingList tbody tr.itemRow").each(function(){var e=parseInt($("input[type='text']",this).val(),10);e<0&&(e=0);var t=parseFloat($(".price",this).text().replace(window.PaymentManager.currencySymbol(),"").replace(/,/gi,""),10);isNaN(t)||("true"!=$(".hdnVATExempt",this).val()&&(t+=roundAmount(t/100*parseFloat($(".hdnVATRate",this).val()),2)),t=evenRound(t,2),a+=t*e)}),a}function delChanged(){var e,t=$("#deliveryOptions").val(),a=!1;$(".paymentForm").removeClass("hidden"),""!=t&&null!=t&&null!=t&&(""==(e=t.split("_"))[0]||"00000000-0000-0000-0000-000000000000"==e[0]?$(".deliveryAmount h3 span").text(""):(t=parseFloat(e[1]),$(".deliveryAmount h3 span").text(window.PaymentManager.currencySymbol()+evenRound(t,2).toFixed(2)),a=!0));t=updateTotal();updateVAT();var n=!1;$(".hdnIsDigital").each(function(){var e=$(this).val(),t=$(this).parent().find("input[type='text']").val();"true"!==e&&0<t&&(n=!0)}),!a&&n||0!=t?calculateStep():calculateStep(!0)}function getDonationAmount(){var e=$(".addDonation input").val();return""!=e&&null!=e||(e=0),e=(e=parseFloat(e))<0?0:e}var delOptions=[];function parseDeliveryOption(e){e=e.split("_");return{id:e[0],cost:parseFloat(e[1]),vat:Boolean.parse(e[3])?parseFloat(e[4]):0}}function filterWeights(){for(var i=checkWeight(),e=$("#deliveryOptions").val(),t=0,a=delOptions.length;t<a;t++){var n=delOptions[t],r=parseDeliveryOption(n.v);n.v===deliveryOptionPlaceholder?$("#deliveryOptions").prepend("<option value='"+n.v+"'>"+n.t+"</option>"):$("#deliveryOptions").append("<option value='"+n.v+"' data-cost='"+r.cost+"' data-vat='"+r.vat+"'>"+n.t+"</option>")}delOptions=[];var o=[];$("#deliveryOptions").html($("option","#deliveryOptions").sort(function(e,t){var a=e.value.split("_"),n=parseFloat(a[1]),e=parseFloat(a[2]),a=t.value.split("_"),t=parseFloat(a[1]),a=parseFloat(a[2]);return n==t?e==a?0:e<a?-1:1:n==t?0:n<t?-1:1})),$("#deliveryOptions option").each(function(){var e,t,a=$(this).val(),n=!1;$(".hdnIsDigital").each(function(){var e=$(this).val(),t=$(this).parent().find("input[type='text']").val();"true"!==e&&0<t&&(n=!0)}),a!=deliveryOptionPlaceholder&&(e=$(this).text(),t=a.split("_"),t=parseFloat(t[2]),!isNaN(t)&&t<i||!n?(delOptions.push({v:a,t:e}),$(this).remove()):(t=e.split(" -"),-1<$.inArray(t[0],o)&&(delOptions.push({v:a,t:e}),$(this).remove()),o.push(t[0])))}),$("#deliveryOptions").val(e)}function updateTotal(){var e,t=$("#deliveryOptions").val(),a=!1;filterWeights(),""!=t&&null!=t?(""==(n=t.split("_"))[0]||"00000000-0000-0000-0000-000000000000"==n[0]?t=0:(t=parseFloat(n[1]),a="True"==n[3]),a&&(t*=parseFloat("1."+n[4].replace(".",""))),0<(e=basketTotalIncVat()+t)?$(".promoCode").removeClass("hidden"):$(".promoCode").addClass("hidden")):0<(e=basketTotalIncVat())&&$(".promoCode, .signInLink, .paymentEtc").removeClass("hidden"),e+=getDonationAmount();var n=getNumberOfItems(),t=evenRound(e,2).toFixed(2);return $(".total span").text(window.PaymentManager.currencySymbol()+t),"0.00"!=t?$("li.menuAdminBasket a span:last-child").text(window.PaymentManager.currencySymbol()+t+" ("+n+")"):1==n?$("li.menuAdminBasket a span:last-child").text("("+n+" item)"):$("li.menuAdminBasket a span:last-child").text("("+n+" items)"),e}function checkWeight(){var n=0;return $("tbody td.quantityColumn").each(function(){""==(e=$(".hdnWeight",this).val())&&(e=0);var e=parseFloat(e),t="true"!==$(".hdnIsDigital",this).val(),a=parseInt($("input[type='text']",this).val(),10);t&&!isNaN(a)&&(n+=e*a)}),n}function showHideDelivery(){var a=!1;$("tbody td.quantityColumn").each(function(){var e,t=$("input[type='text']",this).val();""!=t&&(t=parseInt(t,10),e="true"==$(".hdnIsDigital",this).val(),0<t&&!e&&(a=!0))}),a?$(".deliveryAmount").removeClass("hidden"):$(".deliveryAmount").addClass("hidden")}function setPaymentCompletionContent(){var e=PaymentManager.getSelectedPaymentMethod();"credit-card"===e||"google-pay"===e||"apple-pay"===e?($("#purchase-button").html("Add payment details"),$("#terms-and-conditions-section").addClass("hidden")):($("#purchase-button").html("Complete purchase"),$("#terms-and-conditions-section").removeClass("hidden"))}var map=null,geocoder=null,markersArray=[],formInput={tags:[],latLon:null};function validatePost(){var e=[];e.push(_validateField("div.formQuestion.postCreateRights"));for(var t=!0,a=0,n=e.length;a<n;a++)e[a]||(t=!1);return jumpAndFocusError(),t}function initialiseFormPost(){$("input","div.formQuestion.postCreateRights").on("blur",function(){_validateField("div.formQuestion.postCreateRights")}),$(".postCreateTagsBtn").on("click",function(e){e.preventDefault();e=$("#postTags").val();$(".tagsAdded").append('<li id="tag_'+e+'">'+e+' <a class="buttonIcon remove" href="javascript: removeTag(\''+e+'\')" title="Remove tag">Remove</a></li>'),$("#postTags").val(""),formInput.tags.push(e)}),mapInitialize()}function removeTag(e){return $("#tag_"+e).remove(),aryRemove(formInput.tags,e),!1}function mapInitialize(){var e,t,a;return $("#map").is(":visible")&&(e={zoom:5,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},t="United Kingdom",$("#LocationcountryText").val()&&(t=$("#LocationcountryText").val()),map=new google.maps.Map(document.getElementById("map"),e),(geocoder=new google.maps.Geocoder).geocode({address:t},function(e,t){t==google.maps.GeocoderStatus.OK&&(a=e[0].geometry.location,map.setCenter(a),formInput.latLon=a.lat()+","+a.lng(),addMarker(a))})),!1}function clearOverlays(){if(markersArray)for(i in markersArray)markersArray[i].setMap(null)}function addMarker(e){var t=new google.maps.Marker({position:e,map:map,name:"",title:"",draggable:!0});markersArray.push(t),google.maps.event.addListener(t,"dragend",function(){formInput.latLon=t.position.lat()+","+t.position.lng()}),google.maps.event.addListener(t,"click",function(){})}function updateMap(){var e=$("#LocationAddressLine1").val()+", "+$("#LocationAddressLine2").val()+", "+$("#LocationaddressCity").val()+", "+$("#LocationpostcodeLookUp").val()+", "+$("#LocationddlCountry:selected").text();geocoder.geocode({address:e},function(e,t){t==google.maps.GeocoderStatus.OK?(map.setCenter(e[0].geometry.location),formInput.latLon=e[0].geometry.location.lat()+","+e[0].geometry.location.lng(),clearOverlays(),addMarker(e[0].geometry.location)):alert("Sorry we could not find that location")})}function ShowSignIn(){$(".registerWrapper").addClass("hidden")}function showMainContent(){$(".tabWrapper, .registerWrapper").addClass("hidden"),$(".postCreatePageDetails, .postCreateButtons").removeClass("hidden")}function validatePostCreate(e){var t=[];t.push(_validateField("div.formQuestion.postCreateTitle"));var a=validatePost();null==window.validateRegister||validateRegister(!0)||(a=!1);for(var n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function initialiseFormPostCreate(){$("input","div.formQuestion.postCreateTitle").on("blur",function(){_validateField("div.formQuestion.postCreateTitle")}),$("#btnCreate").on("click",function(e){return e.preventDefault(),!!validatePostCreate()&&(0<$("#firstName").get().length?register(function(){formPostCreateWork(!0)}):void formPostCreateWork(!1))})}function formPostCreateWork(e){e={title:$("#appealTitle").val(),overview:$("#appealOverview").val(),content:$("#postCreateContent").val(),imgID:imageVideoInput.imgID,vimeoID:imageVideoInput.vimeoID,youtubeID:imageVideoInput.youtubeID,postcode:$("#LocationpostcodeLookUp").val(),address1:$("#LocationAddressLine1").val(),address2:$("#LocationAddressLine2").val(),townCity:$("#LocationaddressCity").val(),idCountry:$("#LocationddlCountry").val(),latLon:formInput.latLon,tags:formInput.tags.join("|"),allowComments:!0,notifyComments:$("#notifyComments").prop("checked"),confirmRights:$("#confirmRights").prop("checked"),justRegistered:e};$(".postCreateButtons").addClass("hidden"),$(".loadWait").removeClass("hidden"),$.post("/BaseUI/v2_4/Handlers/Create/Page.ashx",e).done(function(e){var t=e.split("|");e=t[0],$(".postCreateFormWrapper").slideUp(),$(".loadWait").addClass("hidden"),"NoReq"==e?($(".commentSuccessNoReq").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):"Req"==e?$(".commentSuccessReq").removeClass("hidden"):"NoReqNP"==e?($(".commentSuccessNoReq, .noProfilePic").removeClass("hidden"),$("#userPost1, #userPost2").attr("href",t[1])):("ReqNP"==e?$(".commentSuccessReq, .noProfilePic"):$(".commentSuccessReg")).removeClass("hidden"),$("html, body").animate({scrollTop:0},"fast")})}function _telephoneVal(e){return!e.match(/[^0-9 ]/g)}function _mobileVal(e){return!e.match(/[^0-9 ]/g)}function _emailVal(e){return validateEmail(e)}function getRegisterRequest(){var e=blankNulls($("#registeremail").val()),t=blankNulls($("#firstName").val()),a=blankNulls($("#lastName").val()),n=blankNulls($("#contactViaEmail").prop("checked")),i=blankNulls($("#contactViaTel").prop("checked")),r=blankNulls($("#telephone").val()),o=blankNulls($("#title").val()),s=blankNulls($("#lastUploadedFileName").val()),l=blankNulls($("#contactViaSMS").prop("checked")),d=blankNulls($("#mobile").val()),u=blankNulls($("#contactViaPost").prop("checked")),c=blankNulls($("#postcodeLookUp").val()||$("#registerpostcodeLookUp").val()),p=blankNulls($("#AddressLine1").val()||$("#registerAddressLine1").val()),m=blankNulls($("#AddressLine2").val()||$("#registerAddressLine2").val()),h=blankNulls($("#addressCity").val()||$("#registeraddressCity").val()),v=blankNulls($("#ddlCountry").val()||$("#registerddlCountry").val());$(".registerGiftAid").is(":visible")&&(""==c&&(c=blankNulls($("#giftaidpostcodeLookUp").val())),""==p&&(p=blankNulls($("#giftaidAddressLine1").val())),""==m&&(m=blankNulls($("#giftaidAddressLine2").val())),""==h&&(h=blankNulls($("#giftaidaddressCity").val())),""==v&&(v=blankNulls($("#giftaidddlCountry").val())));return{email:e,firstName:t,lastName:a,optInEmail:n,optInTelephone:i,telephoneNumber:r,optInSMS:l,mobileNumber:d,optInPost:u,postcode:c,address1:p,address2:m,townCity:h,idCountry:v,optInThirdParty:!1,isFundraiser:blankNulls(0<$("#hdnIsFundraiser").get().length),registerAction:blankNulls($("#hdnRegisterAction").val()),idGroup:blankNulls($("#hdnGroupID").val()),title:o,contactReasons:$("#contactReasonsChosen").val(),profilePictureFileName:s}}function getRegisterQS(){var e=getRegisterRequest();return"registeremail="+encodeURIComponent(e.email)+"&firstName="+e.firstName+"&lastName="+e.lastName+"&optInEmail="+e.optInEmail+"&optInTelephone="+e.optInTelephone+"&tel="+e.telephoneNumber+"&optInSms="+e.optInSMS+"&mobile="+e.mobileNumber+"&optInPost="+e.optInPost+"&postcode="+e.postcode+"&address1="+e.address1+"&address2="+e.address2+"&townCity="+e.townCity+"&idCountry="+e.idCountry+"&optInThirdParty="+e.optInThirdParty+"&isFundraiser="+e.isFundraiser+"&registeraction="+e.registerAction+"&idGroup="+e.idGroup+"&title="+e.title+"&contactReasonsChosen="+escape(e.contactReasons)+"&profilePictureFileName="+e.profilePictureFileName}function register(a){return!!validateRegister()&&($(".registerButtons button").addClass("hidden"),$(".loadWait").removeClass("hidden"),$.get("/baseui/v2_4/handlers/register.ashx?"+getRegisterQS(),function(e){if("Exists"==e){var t=window.location;return null!=window.origURL&&(t=window.origURL),window.location="/login?ReturnURL="+escape(t),!1}$("li.menuAdminLogin a").text("Log out").attr("href","/logout"),null!=a&&a(e)}),!0)}function validateRegister(e){var t=[];t.push(_validateField(".registerForm div.formQuestion.firstName")),t.push(_validateField(".registerForm div.formQuestion.lastName")),t.push(_validateField(".registerForm div.formQuestion.email",_emailVal)),t.push(_validateField(".registerForm div.formQuestion.telephone",_telephoneVal)),t.push(_validateField(".registerForm div.formQuestion.mobile",_mobileVal)),t.push(_validateField(".registerForm div.formQuestion.termsConditions"));var a=!!window.hasOwnProperty("titleRequired")&&window.titleRequired;t.push(_validateField("div.formQuestion.title",_titleVal,!a)),$(".registerGiftAid .postcodeLookUp").is(":visible")&&(t.push(checkPostcode(".registerGiftAid div.formQuestion.postcodeLookUp","#giftaidddlCountry")),t.push(_validateField(".registerGiftAid div.formQuestion.enterAddressLine1")),t.push(_validateField(".registerGiftAid div.formQuestion.enterAddressCity"))),$(".registerFields .formThirdStep.postcodeLookUp").is(":visible")&&(t.push(checkPostcode(".registerFields div.formThirdStep.postcodeLookUp","#ddlCountry")),t.push(_validateField(".registerFields div.formThirdStep.enterAddressLine1")),t.push(_validateField(".registerFields div.formThirdStep.enterAddressCity")));for(var n=!0,i=0,r=t.length;i<r;i++)t[i]||(n=!1);return!0!==e&&jumpAndFocusError(),n}function initialiseFormRegister(){$("input",".registerForm div.formQuestion.firstName").on("blur",function(){_validateField(".registerForm div.formQuestion.firstName")}),$("input",".registerForm div.formQuestion.lastName").on("blur",function(){_validateField(".registerForm div.formQuestion.lastName")}),$("input",".registerForm div.formQuestion.email").on("blur",function(){_validateField(".registerForm div.formQuestion.email",_emailVal),$(".registerForm .emailAddress").text("at "+$(this).val())}),$("input",".registerForm div.formQuestion.telephone").on("blur",function(){_validateField(".registerForm div.formQuestion.telephone",_telephoneVal);var e=$(this).val();""!=e&&(e="at "+e),$(".registerForm div.contactViaTel label span").text(e)}),$("input",".registerForm div.formQuestion.mobile").on("blur",function(){_validateField(".registerForm div.formQuestion.mobile",_mobileVal);var e=$(this).val();""!=e&&(e="at "+e),$(".registerForm div.contactViaSMS label span").text(e)}),$("input",".registerForm div.formQuestion.termsConditions").on("blur",function(){_validateField(".registerForm div.formQuestion.termsConditions")}),$("#displayNameAlt").on("click",function(){$(this).prop("checked")?$("#displayName").prop("checked",!0):$("#displayName").prop("checked",!1)}),$("#displayName").on("click",function(){$(this).prop("checked")?$("#displayNameAlt").prop("checked",!0):$("#displayNameAlt").prop("checked",!1)})}function pRegisterLookupCallback(e){$(".contactViaPost label span").text(" at "+e.StreetAddress+", "+e.Place)}function initialiseFundraiserList(){$("#fundraiserNameSearch").on("keydown",function(e){if(13==e.keyCode)return fundraiserSearchFunc(),e.preventDefault(),!1}),$('.findAFundraiser .categoryFilterContent input[type="checkbox"]').length&&loadFundraisersAjax(processCheckboxesForFundraiserList()+"&NoMarkup=1",0,!1,!1),$('.findAFundraiser .categoryFilterContent input[type="checkbox"]').on("change",function(){loadFundraisersAjax(processCheckboxesForFundraiserList()+"&NoMarkup=1",0,!1,!1)}),$(".findAFundraiser .categoryFilterContent select").length&&loadFundraisersAjax(processDropdownsForFundraiserList()+"&NoMarkup=1",0,!1,!0),$(".findAFundraiser .categoryFilterContent select").on("change",function(){loadFundraisersAjax(processDropdownsForFundraiserList()+"&NoMarkup=1",0,!1,!0)}),$(".clearcombinedfilters").on("click",function(){return reset("appeals"),!1})}function processCheckboxesForFundraiserList(){var e=$(this).attr("value"),t=1==$(this).prop("checked"),a=$(this).parent().hasClass("firstLevelFilter");t?$('.findAFundraiser .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$(".childOf-"+e+" > input").prop("checked",!0)}):uncheckAllChildrenForFundraiserList(e),a||t||$(this).parent().prevAll(".firstLevelFilter:first").find("input").prop("checked",!1),$(".appliedFilters").removeClass("hidden").find("li > span").parent().remove();var n,i=[];$('.findAFundraiser .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$(".childOf-"+e+" > input").prop("checked",!0)}),$('.findAFundraiser .categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value"),t=$(this).next().text();$(".appliedFilters").append('<li><span class="filter">'+t+" <a class=\"remove\" href=\"javascript: reset()\" onclick=\"$('body').removeClass('categoryFiltersOn');\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>"),i.push(e)});return 0<i.length?(n=i.join("|"),$("body").addClass("categoryFiltersOn")):(n=getParameterByName("CategoryTitle","/Category/"),$("body").removeClass("categoryFiltersOn")),n}function processDropdownsForFundraiserList(){var e,t=[],a=getParameterByName("CategoryTitle","/Category/");$(".findAFundraiser .categoryFilterContent select").each(function(){var e=$(this).find(":selected").attr("value");"--"!==e&&t.push(e)});return 0<t.length?(t.push(a),e=t.join("|"),$("body").addClass("categoryFiltersOn")):(e=a,$("body").removeClass("categoryFiltersOn")),e}function uncheckAllChildrenForFundraiserList(e){$(".childOf-"+e+" > input").prop("checked",!1)}function loadMoreFundraisers(e,t){e=e+"&StartAt="+t+"&NoMarkup=1";return $(".listFooter").remove(),loadFundraisersAjax(e,t,!0,!1),!1}function loadFundraisersAjax(e,t,a,n){var i;0<$(".funArea").length&&(i=!0),a||(i?$(".funArea"):$(".fundraiserSearchResults")).empty(),e=e+"&SubsiteTitle="+getParameterByName("SubsiteTitle","/Site/"),$.get("/BaseUI/v2_4/Handlers/ListingFundraisersAjax.aspx?CategoryTitle="+e+"&q="+$("#fundraiserNameSearch").val()+"&e="+$("#fundraiserEventFilter").val()+"&CombineFilters="+n,function(e){i?($(".funArea").append(e),$(".funArea > section").length):($(".fundraiserSearchResults").append(e),$(".fundraiserSearchResults > section").length);window.history&&window.history.pushState&&(e=window.location.href,$("<div>").append($(".listContent").clone()).html(),history.pushState($(".listContent").html(),null,e)),0<$(".listedPost.listedFundraiser").length?$("#runningTotal").text($(".listedPost.listedFundraiser").length):$("#runningTotal").text("0")})}function commentsSelected(){return $("#fundraiserComments").removeClass("hidden"),$("#fundraiserDashboard").addClass("hidden"),$(".dashul li").removeClass("active"),$(".fct").addClass("active"),!1}function fundraiserDashboard(){return $("#fundraiserComments").addClass("hidden"),$("#fundraiserDashboard").removeClass("hidden"),$(".dashul li").removeClass("active"),$(".fdt").addClass("active"),!1}function fundraiserButton_Click(){alert("This feature will be available once the page is live. Please activate your account by clicking the link in the email we sent you if you haven't already")}function fundraiserSearchFunc(){var e=$("#fundraiserEventFilter").val(),t=getParameterByName("SubsiteTitle","/Site/"),t={q:$("#fundraiserNameSearch").val(),IDEvent:e,idCategory:$("#hdnIDCategory").val(),SubsiteTitle:t};return $(".loadWait").removeClass("hidden"),$(".funArea").html(""),$(".backToTop").addClass("hidden"),$.post("/BaseUI/v2_4/Handlers/AppealFundraiserSearch.aspx",t).done(function(e){$(".loadWait").addClass("hidden"),(0<$(".funArea").length?$(".funArea"):$(".fundraiserSearchResults")).html(e),0<$(".listedPost.listedFundraiser").length?$("#runningTotal").text($(".listedPost.listedFundraiser").length):$("#runningTotal").text("0"),$(".backToTop").removeClass("hidden")}),!1}function initialiseGeneral(){$("body").addClass("js");var a=$(".menuMainAlt"),t=$("#menuMain");a.on("click",function(e){e.preventDefault(),a.toggleClass("active"),t.toggleClass("active"),a.hasClass("active")?(a.attr("aria-expanded","true"),t.attr("aria-expanded","true")):(a.removeAttr("aria-expanded"),t.removeAttr("aria-expanded"))}),$("body").on({mouseenter:function(){var e,t;a.is(":visible")||0<(e=$(this).find("> ul")).get().length&&(t=$(window).width(),e.each(function(){var e=$(this).offset().left+$(this).width();t<e&&$(this).css("left","-100%")}))}},"#menuMain ul ul li, #menuSub ul ul li");var e=localStorage.getItem("altStyle");null!=e&&""!==e&&(e=parseInt(e,10),isNaN(e)||$("html").addClass("altStyle"+e)),$(".expandableBlock").length&&$(".expandableBlock").each(function(e){var t=$(".expandableBlock:eq("+e+") .accordianBody.contentBlockWrapper.hidden").attr("id"),t=parseInt(t.match(/\d+/g));$(".expandableLink:eq("+e+")").html("<a id='link"+t+"' class='buttonIcon expand' href=\"javascript:ToggleExpColDiv2('"+t+"');\" title='Expand'>"+$(".expandableLink:eq("+e+")").html()+"</a>"),$(".accordianHeaderText:eq("+e+")").html("<a href=\"javascript:ToggleExpColDiv2('"+t+"');\">"+$(".accordianHeaderText:eq("+e+")").html()+"</a>")}),$.get("/frontend/api/shopping-basket/summary").done(function(e){$(".basket-summary").text(e)})}function setMenuMainMobileClass(){var e=$(".menuMainAlt"),t=$("#menuMain");e.is(":visible")?(t.addClass("menuMain--mobile"),t.hasClass("active")?t.attr("aria-expanded",!0):t.removeAttr("aria-expanded")):(t.removeClass("menuMain--mobile"),t.removeAttr("aria-expanded"))}function aryRemove(e,t){for(var a=e.indexOf(t);-1!==a;)e.splice(a,1),a=e.indexOf(t)}function raisePostCounter(e){$(document).ready(function(){$.get("/baseui/v2_4/handlers/postcounter.ashx?IDPost="+e).done(function(e){})})}function newsletterSignUp(n){$("#groupSignUpBtn").prop("disabled",!0);var e="",t="",a="",i=$("#newslettergroupid"+n).val().trim(),r=!1;$("#newsletterFields"+n+" .validateRequired").addClass("hidden"),$("#newsletterFields"+n+" .validateError").addClass("hidden"),$("#newsletterFields"+n+" .formQuestion input").removeAttr("aria-describedby").attr("aria-invalid","false");var o=$("#newsletteremail"+n).is(":visible");if(o&&(e=$("#newsletterfirstName"+n).val().trim(),t=$("#newsletterlastName"+n).val().trim(),0===(a=$("#newsletteremail"+n).val().trim()).length?($("#newsletteremailRequiredError"+n).removeClass("hidden"),$("#newsletteremail"+n).attr("aria-describedby","newsletteremailRequiredError"+n).attr("aria-invalid","true").focus(),r=!0):validateEmail(a)||($("#newsletteremailFormatError"+n).removeClass("hidden"),$("#newsletteremail"+n).attr("aria-describedby","newsletteremailFormatError"+n).attr("aria-invalid","true").focus(),r=!0),0===t.length&&($("#newsletterlastNameRequiredError"+n).removeClass("hidden"),$("#newsletterlastName"+n).attr("aria-describedby","newsletterlastNameRequiredError"+n).attr("aria-invalid","true").focus(),r=!0),0===e.length&&($("#newsletterfirstNameRequiredError"+n).removeClass("hidden"),$("#newsletterfirstName"+n).attr("aria-describedby","newsletterfirstNameRequiredError"+n).attr("aria-invalid","true").focus(),r=!0),r))return $("#groupSignUpBtn").prop("disabled",!1),!1;o=$("#honeybeeritn").val(),r=$("#honeybeeritn2").val();return $.post("/baseui/v2_4/handlers/newslettersignup.ashx",{firstName:e,lastName:t,email:a,groupid:i,honeybeeritn:o,honeybeeritn2:r}).done(function(t){var a=$("#newsletterSuccess"+n);try{var e=JSON.parse(t);a.html(e.Message),a.removeClass("hidden"),a.parent().find("button").addClass("hidden"),$("#newsletterFields"+n).slideUp()}catch(e){a.html(t),a.removeClass("hidden"),a.parent().find("button").addClass("hidden"),$("#newsletterFields"+n).slideUp()}}),!1}function submitSearch(e){logRecaptchaAction("site_search",e);var t=$("#siteSearch"),e=t.val();t.val(stripHTML(e))}function stripHTML(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}function vimeopost(e,t,a){0!==a.length&&(e={method:e},t&&(e.value=t),t=a.attr("src"),a[0].contentWindow.postMessage(JSON.stringify(e),t))}function callPlayer(a,e,t){window.jQuery&&a instanceof jQuery&&(a=a.get(0).id);var n=document.getElementById(a);n&&"IFRAME"!=n.tagName.toUpperCase()&&(n=n.getElementsByTagName("iframe")[0]),callPlayer.queue||(callPlayer.queue={});var i=callPlayer.queue[a],r="complete"==document.readyState;if(r&&!n)window.console&&console.log("callPlayer: Frame not found; id="+a),i&&clearInterval(i.poller);else if("listening"===e)n&&n.contentWindow&&(e='{"event":"listening","id":'+JSON.stringify(""+a)+"}",n.contentWindow.postMessage(e,"*"));else if(r&&(!n||n.contentWindow&&(!i||i.ready))&&(i&&i.ready||"function"!=typeof e)){if(n&&n.contentWindow){if(e.call)return e();n.contentWindow.postMessage(JSON.stringify({event:"command",func:e,args:t||[],id:a}),"*")}}else(i=i||(callPlayer.queue[a]=[])).push([e,t]),"poller"in i||(i.poller=setInterval(function(){callPlayer(a,"listening")},250),o(1,function e(t){if(!n){if(!(n=document.getElementById(a)))return;if("IFRAME"!=n.tagName.toUpperCase()&&!(n=n.getElementsByTagName("iframe")[0]))return}if(t.source===n.contentWindow)for(clearInterval(i.poller),i.ready=!0,o(0,e);tmp=i.shift();)callPlayer(a,tmp[0],tmp[1])}));function o(e,t){var a=e?window.addEventListener:window.removeEventListener;a?a("message",t,!1):(e?window.attachEvent:window.detachEvent)("onmessage",t)}}function playVid(e,t){return!(null==e||null==e.target||!$(e.target).is("a")||$(e.target).hasClass("showsVideo"))||($("#videoPopup"+t).removeClass("hidden"),0<$("#videoPopup"+t+" .youtube").get().length?(callPlayer("iframeYoutube"+t,"playVideo"),-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(e=$("#iframeYoutube"+t).attr("src"),$("#iframeYoutube"+t).attr("src",e))):vimeopost("play",null,$("iframe.vimeo","#videoPopup"+t)),!(window.vidPlaying=!0))}function closeVid(e){return $("#videoPopup"+e).addClass("hidden"),0<$("#videoPopup"+e+" .youtube").get().length?callPlayer("iframeYoutube"+e,"pauseVideo"):vimeopost("pause",null,$("#videoPopup"+e+" iframe.vimeo")),window.vidPlaying=!1}function ToggleExpColDiv(e){var t=$("#dv"+e),e=$("#link"+e);t.is(":visible")?(t.hide(),e.html("Read more <img src='/App_Themes/Graphics/Icons/Application_Get.png'>")):(t.show(),e.html("Close <img src='/App_Themes/Graphics/Icons/Application_Put.png'>"))}function ToggleExpColDiv2(e){var t=$("#dv"+e);$("#link"+e);t.is(":visible")?(t.addClass("hidden"),t.attr("aria-expanded","false")):(t.removeClass("hidden"),t.attr("aria-expanded","true"))}function showForm(e,t){0===$("#overlayContainer").get().length&&$("body").append('<div id="overlayContainer"></div>');var a=$(document).height(),t="<iframe id='if1' allowTransparency='true' scrolling='no' style='height: "+a+"px' src='/handlers/formspopup.aspx?formName="+e+"&fileId="+t+'\' onload=\'$("#overlayContainer").show(); if ($("#if1").contents().height() > $(document).height()) { $("#if1, #overlayContainer").css("height", $("#if1").contents().height() + "px"); };  $("html, body").animate({ scrollTop: 0 }, "fast"); this.contentWindow.focus();\' />';$("#overlayContainer").css("height",a+"px").html(t),$("#if1").attr("allowTransparency","true")}function hideForm(){$("#overlayContainer").remove()}function getParameterByName(e,t){t=t.toLowerCase(),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);if(null!=e)return decodeURIComponent(e[1].replace(/\+/g," "));if(void 0!==t){t=window.location.href.toLowerCase().split(t);if(2<=t.length){t=t[1].split("?")[0];return-1!=(t=t.split("#")[0]).indexOf("/")?t.split("/")[0]:t}}return""}function reset(e){var t=!1;$(".appliedFilters").addClass("hidden").find("li > span").parent().remove(),$('.categoryFilterContent input[type="checkbox"]').each(function(){$(this).prop("checked",!1)}),$(".categoryFilterContent select").each(function(){$(this).val("--"),t=!0});var a=getParameterByName("CategoryTitle","/Category/");"appeals"==e?loadFundraisersAjax(a,0,!1,t):"currentAppeals"==e?($("#currentSingleFilters").val(""),t?currentProjectsLoadMoreCombined(!0,!1,!0):currentProjectsLoadMore(!0,!1)):"completedAppeals"==e?($("#completedSingleFilters").val(""),t?completedProjectsLoadMoreCombined(!0,!1,!0):completedProjectsLoadMore(!0,!1)):loadListingAjax("?CategoryTitle="+a+"&NoMarkup=1",null,t)}function expandNextSection(e){return($(e).is("header")?$(e):$(e).parent()).next().toggleClass("hidden"),!1}function handleClickKeyboardIntent(e){var t=e.keyCode||e.which;32===t&&e.preventDefault(),13!==t&&32!==t||document.activeElement.click()}function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function generateUrlSlug(e){return removeDiacritics(e).toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-").replace(/_+/g,"-")}function removeDiacritics(e){for(var t=0;t<diacriticsMap.length;t++)e=e.replace(diacriticsMap[t].letters,diacriticsMap[t].base);return e}function validateUrl(e){return!!e&&(!e.includes("_")&&e===encodeURIComponent(e.replace(/[^\w -]+/g,"")))}$(document).ready(function(){0<$(".listedPost.listedFundraiser").length?$("#runningTotal").text($(".listedPost.listedFundraiser").length):$("#runningTotal").text("0")}),$(window).on("load",function(){setMenuMainMobileClass()}),$(window).on("orientationchange",function(){window.setTimeout(function(){setMenuMainMobileClass()},500)}),$(document).on("mouseup",function(e){var t=$(".videoPopup:not(.hidden)");(!t.is(e.target)&&0===t.has(e.target).length||$(e.target).hasClass("videoBackground"))&&($("iframe.youtube",t).each(function(){callPlayer($(this).attr("id"),"pauseVideo")}),$("iframe.vimeo",t).each(function(){vimeopost("pause",null,$(this))}),t.addClass("hidden"))});var diacriticsMap=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];function generateUUID(){var a=(new Date).getTime(),n=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random();return 0<a?(t=(a+t)%16|0,a=Math.floor(a/16)):(t=(n+t)%16|0,n=Math.floor(n/16)),("x"===e?t:3&t|8).toString(16)})}function initialiseInMemCreate(){function t(){$("#btnCreate, .loggedIn#btnContinue").addClass("hidden"),$(".loadWait").removeClass("hidden"),$(".thankYouHeader").removeClass("hidden"),$(".introductionHeader").addClass("hidden");var e={name:$("#name").val(),description:$("#description").val(),dateOfBirth:$("#dateOfBirth").val(),dateOfDeath:$("#dateOfDeath").val(),imgID:imageVideoInput.imgID,allowComments:1==$("#allowComments").prop("checked"),moderateComments:1==$("#moderateComments").prop("checked"),associatedAppeal:$("#postCreateAssociatedEvent").val(),fundraise:1==$("#othersFundraise").prop("checked"),showTotal:1==$("#totalAmountRaised").prop("checked"),showDonations:1==$("#donationsShow").prop("checked"),titleurl:$("#titleurl").val()};$.post("/BaseUI/v2_4/Handlers/Create/InMemoryOf.ashx",e).done(function(e){var t=JSON.parse(e);$(".inMemoryCreateFormWrapper").slideUp(),$(".loadWait").addClass("hidden"),$(".inMemoryCreateSuccess").removeClass("hidden"),$("html, body").animate({scrollTop:0},"fast"),$("#btnView").on("click",function(){window.location="/inmemoryof/"+t.TitleURL}),t.CanShare?(e=$("#emailLink").attr("href"),$("#emailLink").attr("href",e.replace("/appeal/example","/inmemoryof/"+t.TitleURL).replace("?subject=example",t.Title)),e=$("#facebookLink").attr("href"),$("#facebookLink").attr("href",e.replace("/appeal/example&t=example","/inmemoryof/"+t.TitleURL+"&t="+t.Title)),e=$("#twitterLink").attr("href"),$("#twitterLink").attr("href",e.replace("/appeal/example","/inmemoryof/"+t.TitleURL).replace("?text=example","?text="+t.Title))):$(".shareWrapper, .ifShareText").addClass("hidden"),$("#btnStartFundraising").on("click",function(){null!=t.IDAppeal?window.location="/appeals/post?IDAppeal="+t.IDAppeal:window.location="/appeals/post"})})}$.datepicker.setDefaults($.datepicker.regional[""]),$(".inMemoryCreateStartDate input, .inMemoryCreateEndDate input, .inMemoryCreateLocationDate input").datepicker({dateFormat:"dd/mm/yy"}),$("input","div.formQuestion.inMemoryCreateTitle").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateTitle")}),$("textarea","div.formQuestion.inMemoryCreateOverview").on("blur",function(){_validateField("div.formQuestion.inMemoryCreateOverview")}),$("input","div.formQuestion.inMemoryCreateStartDate").on("blur",function(){_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateStartDate",_dateVal,!0)}),$("input","div.formQuestion.inMemoryCreateEndDate").on("blur",function(){_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateEndDate",_dateVal,!0)}),$("input","div.formQuestion.inMemoryCreateLocationDate").on("blur",function(){_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateLocationDate",_dateVal,!0)}),$("input","div.formQuestion.firstName").on("blur",function(){_validateField("div.formQuestion.firstName")}),$("#includeDetails").on("click",function(){$(".inMemoryCreateLocationDetails").toggleClass("hidden")}),$("#btnContinue").on("click",function(){$(".inMemoryCreateContinue").addClass("hidden"),$(".registerWrapper, .inMemoryCreateButtons").removeClass("hidden")}),$("#othersFundraise").on("click",function(){$(".startFundraising").toggleClass("hidden")}),$("input",".formQuestion.inMemoryCreateTitleURL, .formQuestion.inMemoryCreateTitle").on("blur",function(){var e=$("input",".formQuestion.inMemoryCreateTitleURL").val();$.get("/baseui/v2_4/handlers/post/titleurlavailable.ashx?url="+e).done(function(t){_validateField(".formQuestion.inMemoryCreateTitleURL",function(e){return"true"===t})})}),$("#btnCreate, .loggedIn#btnContinue").on("click",function(){var e="function"==typeof validateRegister;!validateInMemCreate()||e&&!validateRegister()||(e?register(function(){t()}):t())}),$("#name").on("change",function(){$("#rememberingName, #rememberingName2, #rememberingName3, #rememberingName4").html($(this).val()),""==$("#titleurl").val()&&$("#titleurl").val($(this).val().replace(/ /gi,"-").toLowerCase())})}function validateInMemCreate(e){var t=[];t.push(_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateTitle")),t.push(_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateOverview")),t.push(_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateStartDate",_dateVal,!0)),t.push(_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateEndDate",_dateVal,!0)),t.push(_validateField(".inMemoryCreateFormWrapper div.formQuestion.inMemoryCreateTitleURL"));for(var a=!0,n=0,i=t.length;n<i;n++)t[n]||(a=!1);return!0!==e&&jumpAndFocusError(),a}function initialiseInMemList(){$("#bodyForm").keypress(function(e){if(13==e.keyCode)return e.preventDefault(),memorialSearchFunc(),!1})}function memorialSearchFunc(){var e=$("#memorialNameSearch").val();$(".findAMemorialBtn").addClass("hidden"),$(".loadWait").removeClass("hidden"),$.get("/BaseUI/v2_4/Handlers/InMemoryOf/SearchMemorials.aspx?q="+escape(e),function(e){$("#memorialArea").html(e),$(".findAMemorialBtn").removeClass("hidden"),$(".loadWait").addClass("hidden")})}function initialiseListingPage(){0<$(".listedItem").length?$("#runningTotal").text($(".listedItem").length):$("#runningTotal").text("0");var e=$("#listingModuleType").val();$(".clearcombinedfilters").on("click",function(){return reset(e),!1}),$('.categoryFilterContent input[type="checkbox"]').length&&loadListingAjax("?CategoryTitle="+processCheckboxesForListing()+"&NoMarkup=1",!1,!1),$('.categoryFilterContent input[type="checkbox"]').on("change",function(){loadListingAjax("?CategoryTitle="+processCheckboxesForListing()+"&NoMarkup=1",!1,!1)}),$(".categoryFilterContent select").length&&loadListingAjax("?CategoryTitle="+processDropdownsForListing()+"&NoMarkup=1",!1,!0),$(".categoryFilterContent select").on("change",function(){loadListingAjax("?CategoryTitle="+processDropdownsForListing()+"&NoMarkup=1",!1,!0)})}function processCheckboxesForListing(){var e=$(this).attr("value"),t=1==$(this).prop("checked"),a=$(this).parent().hasClass("firstLevelFilter");t?$('.categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$(".childOf-"+e+" > input").prop("checked",!0)}):uncheckAllChildrenForListing(e),a||t||uncheckAllParentsForListing(this),$(".appliedFilters").removeClass("hidden").find("li > span").parent().remove();var n,i=[];return $('.categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");$(".childOf-"+e+" > input").prop("checked",!0)}),$('.categoryFilterContent input[type="checkbox"]:checked').each(function(){var e=$(this).attr("value");i.push(e)}),0<i.length?(n=i.join("|"),$("body").addClass("categoryFiltersOn")):(n=getParameterByName("CategoryTitle","/Category/"),$("body").removeClass("categoryFiltersOn")),n}function processDropdownsForListing(){var e,t=[],a=getParameterByName("CategoryTitle","/Category/");return $(".categoryFilterContent select").each(function(){var e=$(this).find(":selected").attr("value");"--"!==e&&t.push(e)}),0<t.length?(t.push(a),e=t.join("|"),$("body").addClass("categoryFiltersOn")):(e=a,$("body").removeClass("categoryFiltersOn")),e}var loadMoreClicked=!1;function loadMoreItems(e,t){if(1==loadMoreClicked)return!1;loadMoreClicked=!0;e="?StartAt="+t+"&NoMarkup=1&CategoryTitle="+e;return $(".categoryFilterContent select").length?loadListingAjax(e,!0,!0):loadListingAjax(e,!0,!1),!1}function singleLevelFilterClick(e,t){loadListingAjax("?CategoryTitle="+e+"&NoMarkup=1",!1,!1);e=$("#listingModuleType").val(),t=$(t).text();$(".appliedFilters").find("li > span").parent().remove(),$(".appliedFilters").removeClass("hidden").append('<li><span class="filter">'+t+'<a class="remove" href="javascript: reset(\''+e+"')\" onclick=\"$('body').removeClass('categoryFiltersOn');\">remove</a></span></li>")}function loadListingAjax(e,a,t){var n=$("#hdnModuleType").val();e=n?e+"&CombineFilters="+t+"&ModuleType="+n:e+"&CombineFilters="+t;var i=getExtraParams(),t="/BaseUI/v2_4/Handlers/ListingAjax.aspx";"faqs"===n?t="/BaseUI/v2_4/Handlers/ListingFAQsAjax.aspx":"events"===n&&(t="/BaseUI/v2_4/Handlers/ListingEventsAjax.aspx"),$.get(t+e+i,function(e){var t=e;a||$(".listContent").empty(),$(".listFooter").remove(),$(".listContent").append(t);e=$(".listContent > .listedItem").length;window.history&&window.history.pushState&&(-1===(t=window.location.href).indexOf("Take=")?-1===t.indexOf("?")?t+="?Take="+e:t+="&Take="+e:t=t.replace(/take\=(\d)*/gi,"Take="+e),history.pushState($(".listContent").html(),null,t)),0<$(".listedItem").length?$("#runningTotal").text($(".listedItem").length):$("#runningTotal").text("0"),loadMoreClicked=!1})}function getExtraParams(){var e="",t=getParameterByName("SubsiteTitle","/Site/");t&&(e+="&SubsiteTitle="+t);t=getParameterByName("Blog","/Blogs/");return(t=t||getParameterByName("BlogGroupTitle","/Blogs/"))&&(e+="&blogGroupTitle="+t),e}function uncheckAllChildrenForListing(e){$(".childOf-"+e+" > input").prop("checked",!1)}function uncheckAllParentsForListing(e){$(e).parent().prevAll(".firstLevelFilter:first").find("input").prop("checked",!1)}function showRegister(e){var t=$(".registerWrapper");t.is(":visible")||t.hide().removeClass("hidden").slideDown(),null!=t&&0<t.get().length&&!0!==e&&setTimeout(function(){$("html, body").animate({scrollTop:t.offset().top},"fast")},500)}function initialisePostListing(){var e,t;window.history&&window.history.replaceState&&(e=window.location,t=$("<div>").append($(".listWrapper").clone()).html(),history.replaceState(t,null,e)),window.onpopstate=function(e){null!=e.state&&$(".listWrapper").replaceWith(e.state)}}function getRecaptcha(e){if(window.grecaptcha)return e(window.grecaptcha);var t=window.recaptchaUrl;t?(window.loadingRecaptcha?console.log("Waiting for recaptcha..."):(window.loadingRecaptcha=!0,console.log("Loading recaptcha"),document.getElementById("recaptchaScriptTag").src=t),setTimeout(function(){return getRecaptcha(e)},1e3)):console.log("recaptchaUrl missing")}function logRecaptchaAction(t,a){var e;a?(e=window.grecaptcha?0:5e3,setTimeout(function(){return getRecaptcha(function(e){return e.ready(function(){return e.execute(a,{action:t})})})},e)):console.log("Recaptcha key missing")}function searchFundraisers(){$("#currentResults").val(10);var a=$("#searchPage").val(),e=$("#modules").val(),t=$("#idCategory").val(),n=$("#idTag").val(),i=$("#orderResults").val(),r={q:a,m:e,idCategory:t,idTag:n,sortOrder:i},o="/pages/search.aspx?";return""!=a&&(o+="q="+a+"&",$("#query").val(a)),""!=e&&(o+="m="+e+"&"),""!=t&&(o+="idCategory="+t+"&"),""!=n&&(o+="idTag="+n+"&"),""!=i&&(o+="sortOrder="+i+"&"),o=o.slice(0,-1),history.replaceState(null,null,o),$.post("/BaseUI/v2_4/Handlers/Search.aspx",r).done(function(e){$(".searchResultsArea").html(e);var t,e=$("#resultsCount").val();0<e&&$(".searchFilterWrapper").show(),$("body").removeClass("noResults"),1<e?(t="There are <strong>"+e+"</strong> results that match your search.",$(".noSearchResults").hide(),$(".searchIntroduction").hide(),$(".areSearchResults").html(t),$(".areSearchResults").removeClass("hidden"),$(".areSearchResults").show(),10<e&&$(".button.loadMore.hidden").removeClass("hidden")):1==e?(t="There is <strong>1</strong> result that matches your search.",$(".noSearchResults").hide(),$(".searchIntroduction").hide(),$(".areSearchResults").html(t),$(".areSearchResults").removeClass("hidden"),$(".areSearchResults").show()):0==e&&""!=a||0==e&&""==a&&null!=$("#idCategory").val()&&""!=$("#idCategory").val()||null!=$("#idTag").val()&&""!=$("#idTag").val()?($(".areSearchResults").hide(),$(".searchIntroduction").hide(),$(".noSearchResults").removeClass("hidden"),$(".noSearchResults").show(),$("body").addClass("noResults")):""==a&&($(".areSearchResults").hide(),$(".noSearchResults").hide(),$(".searchIntroduction").removeClass("hidden"),$(".searchIntroduction").show())}),!1}function filterModule(e){return $("#modules").val($("#modules").val()+e+","),searchFundraisers(),$("."+e+"Filter").hide(),$("div#ulFiltersApplied ul").append('<li id="'+e+'ModuleFilter"><span class="filter">'+e+'<a class="buttonIcon remove" href="#" onclick="return removeFilter(&quot;'+e+'&quot;)">remove</a></span></li>'),$("#ulFiltersApplied").show(),!1}function removeFilter(e){var t=$("#modules").val();return $("#modules").val(t.replace(e+",","")),searchFundraisers(),$("."+e+"Filter").show(),$("#"+e+"ModuleFilter").remove(),0==$("#modules").val().length&&$("#ulFiltersApplied").hide(),!1}function loadMoreResults(){var t=parseInt($("#currentResults").val(),10),e=$("#idCategory").val(),a=$("#idTag").val(),n=$("#modules").val(),i=$("#query").val(),e={startNumber:t,q:i,m:n,idTag:a,idCategory:e,sortOrder:$("#orderResults").val()};return $.post("/BaseUI/v2_4/Handlers/Search.aspx",e).done(function(e){$(".searchResultsArea").append(e),$("#currentResults").val(t+10),$("#resultsCount").val()<=t+10&&$(".button.loadMore").addClass("hidden")}),!1}function newSearch(){for(var e=(e=$("#modules").val()).split(","),t=0;t<e.length;t++)removeFilter(e[t]);return searchFundraisers(),!1}function addItemToBasket(t,e,a,n){if(e&&logRecaptchaAction("add_to_basket",e),void 0===a&&(""==(a=$("#productQuantity").val())&&(a="0"),a=parseInt(a)),0!=a&&!isNaN(a))return $.post("/BaseUI/v2_4/Handlers/Shop/AddToBasket.ashx",{titleURL:t,quantity:a}).done(function(e){"false"!=e?($("#liveOutOfStock"+t).addClass("hidden"),$.get("/frontend/api/shopping-basket/summary").done(function(e){$("li.menuAdminBasket a span:last-child").html(e)}),$(n).nextAll(".oneUp:first").removeClass("hidden").oneUp()):$("#liveOutOfStock"+t).removeClass("hidden")}),!1}function swapMainImage(e,t){return $("img.selectedProductBanner").attr("src",e).each(function(){var e=$(this).parent();e.trigger("zoom.destroy"),e.zoom({url:t})}),!1}function setRunningTotal(){0<$(".listedPost.listedProduct").length?$("#runningTotal").text($(".listedPost.listedProduct").length):$("#runningTotal").text("0")}function initialiseShop(){$.fn.oneUp=function(e,t){$.isFunction(e)&&(t=e,e=null);var a=jQuery.extend({distance:40,speed:800,callback:t},e);return this.each(function(){$(this).show().animate({top:"-="+a.distance+"px",opacity:"toggle"},a.speed,"linear",function(){$(this).css({top:""}).hide(a.callback)})})},$("ul.productListOrder li a").on("click",function(e){e.preventDefault(),$("ul.productListOrder li a").removeClass("selected"),$(this).addClass("selected");var t=$("#hdnDeparmentTitle").val(),a=$(this).attr("data-order-by"),n="";-1<a.indexOf("|")&&(a=(e=a.split("|"))[0],n=e[1]),$.get("/BaseUI/v2_4/Handlers/Shop/ProductListing.aspx?DepartmentTitle="+t+"&OrderBy="+a+"&OrderAscending="+n).done(function(e){$("div.listContent section, div.listContent footer").remove(),$("div.listContent").append(e),setRunningTotal()})}),setRunningTotal()}function loadMoreProducts(){var t=$("#hdnDeparmentTitle").val(),e=$("ul.productListOrder li a.selected").attr("data-order-by"),a="";-1<(e=void 0===e?"undefined":e).indexOf("|")&&(e=(n=e.split("|"))[0],a=n[1]);var n,i=void 0===t?!0:!1;return n=(i?$(".shopLandingContent > section"):$(".listContent > section")).length,$.get("/BaseUI/v2_4/Handlers/Shop/ProductListing.aspx?DepartmentTitle="+t+"&OrderBy="+e+"&OrderAscending="+a+"&StartAt="+n+"&IsHome="+i).done(function(e){$("footer.listFooter").remove(),(void 0===t?$(".shopLandingContent"):$("div.listContent")).append(e),setRunningTotal()}),!1}function blankNulls(e){return null==e||void 0===e?"":e}function validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function _dateVal(e){return e.match(/^(\d)?\d[\/](\d)?\d[\/]\d\d\d\d$/)}function _titleVal(e){var t=validTitles;return!(-1==$.inArray(e,validTitles)&&0<t.length)}function checkPostCode(e){if(0===e.length||!e.trim())return!1;var t="[abcdefghijklmnoprstuwyz]",a="[abcdefghklmnopqrstuvwxy]",n="[abdefghjlnpqrstuwxyz]",i=new Array;i.push(new RegExp("^(bf1)(\\s*)([0-6]{1}[abdefghjlnpqrst]{1}[abdefghjlnpqrstuwzyz]{1})$","i")),i.push(new RegExp("^("+t+"{1}"+a+"?[0-9]{1,2})(\\s*)([0-9]{1}"+n+"{2})$","i")),i.push(new RegExp("^("+t+"{1}[0-9]{1}[abcdefghjkpmnrstuvwxy]{1})(\\s*)([0-9]{1}"+n+"{2})$","i")),i.push(new RegExp("^("+t+"{1}"+a+"{1}?[0-9]{1}[abehmnprvwxy]{1})(\\s*)([0-9]{1}"+n+"{2})$","i")),i.push(/^(GIR)(\s*)(0AA)$/i),i.push(/^(bfpo)(\s*)([0-9]{1,4})$/i),i.push(/^(bfpo)(\s*)(c\/o\s*[0-9]{1,3})$/i),i.push(/^([A-Z]{4})(\s*)(1ZZ)$/i),i.push(/^(ai-2640)$/i);for(var r=e,o=!1,s=0;s<i.length;s++)if(i[s].test(r)){i[s].exec(r),r=(r=RegExp.$1.toUpperCase()+" "+RegExp.$3.toUpperCase()).replace(/C\/O\s*/,"c/o "),"AI-2640"==e.toUpperCase()&&(r="AI-2640"),o=!0;break}return!!o&&r}function jumpAndFocusError(){var e,t=$(".alert.validateRequired:visible, .alert.validateError:visible, .error.validateRequired:visible, .error.validateError:visible");0<t.get().length&&(e=$(t[0]).parent(),$("html, body").animate({scrollTop:$(t[0]).offset().top},"fast"),$("input, textarea, select",e).first().focus())}function _validateField(e,t,a,n){if(0==(p=void 0===n?$("input, textarea, select",e):"textarea"==n?$("textarea",e):"select"==n?$("select",e):$("input[type="+n+"]",e)).length)return!0;if(0<p.parents(".hidden").length)return!0;var i="checkbox"==p.attr("type"),r="radio"==p.attr("type"),o=i||r?p.prop("checked"):p.val(),s=[],l=!1;if(1<p.length){if(i||r)for(var d=0,u=p.length;d<u;d++){var c=$(p.get(d)).prop("checked");s.push(c),c&&(l=!0)}else for(d=0,u=p.length;d<u;d++)s.push($(p.get(d)).val());o=s[0]}var p,m=p,n=!o||(!(0<o.length)||""===o.trim());return(i||r)&&!l&&!o||!i&&!r&&n?(showRequiredError(e,m),!0===a):($(".validateRequired",e).addClass("hidden").attr("aria-hidden","true"),m.removeAttr("aria-describedby"),null==t||t.call(this,o,1<s.length?s[1]:null,a)?($(".validateError",e).addClass("hidden").attr("aria-hidden","true"),m.attr("aria-invalid","false"),m.removeAttr("aria-describedby"),!0):((p=$(".validateError",e)).is(":visible")||p.hide().removeClass("hidden").fadeIn().attr("aria-hidden","false"),pairValidationErrorAndInput(p,m),m.attr("aria-invalid","true"),!1))}function pairValidationErrorAndInput(e,t){var a=e.attr("id");a||(a="error"+uuidv4(),e.attr("id",a)),t.attr("aria-describedby",a)}function showRequiredError(e,t){var a=$(".validateRequired",e);return a.is(":visible")||a.hide().removeClass("hidden").fadeIn().attr("aria-hidden","false"),pairValidationErrorAndInput(a,t),t.attr("aria-invalid","true"),$(".validateError",e).addClass("hidden").attr("aria-hidden","true"),a}function initialiseFormMemberTitle(){0<currentTitle.length&&($("#title").val(currentTitle),-1==$.inArray(currentTitle,validTitles)&&0<validTitles.length?($(".title .validateError").text("Please confirm your title").removeClass("hidden"),$(".title .validateError"),$("#title").val("")):-1!=window.location.href.toLowerCase().indexOf("/donate/")&&$(".title").hide()),!!window.hasOwnProperty("titleRequired")&&window.titleRequired&&($("div.formQuestion.title em").removeClass("hidden"),$("div.formQuestion.title span.alert").addClass("validateRequired")),$("#title").autocomplete({source:function(e,t){var e=e.term?0<e.term.length?e.term.trim():e.term:"",a=new RegExp(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");t($.grep(validTitles,function(e){return a.test(e.label||e.value||e)}))},minLength:0,delay:0,select:function(e,t){this.value=t.item.value,$(this).trigger("change"),_validateField("div.formQuestion.title",_titleVal),$(this).blur()}}).on("focus",function(){$(this).autocomplete("search")})}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}!function(){var e=document.createElement("script");e.id="recaptchaScriptTag",e.type="text/javascript",e.defer=!0,e.setAttribute("data-categories","essential"),document.body.append(e)}();var HmrcFieldValidation=function(){function a(e,t){_classCallCheck(this,a),this.countryDropDownElement=e,this.postcodeElement=t,this.UkCountryId="28f16bce-6223-47dc-bf49-b233ec8e5cff",this.countryChanged=this.countryChanged.bind(this),this.countryDropDownElement.addEventListener("change",this.countryChanged),this.setPostcodeLength(e.value)}return _createClass(a,[{key:"countryChanged",value:function(e){e=e.target.value;this.setPostcodeLength(e)}},{key:"setPostcodeLength",value:function(e){e===this.UkCountryId?this.postcodeElement.setAttribute("maxLength",8):this.postcodeElement.setAttribute("maxLength",10)}}]),a}();